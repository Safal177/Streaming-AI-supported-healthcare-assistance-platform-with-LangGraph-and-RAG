<div class="cell code" id="6319d547-2ca7-4953-9888-c63ce7ee1182">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<section id="streaming-ai-supported-healthcare-assistance-platform-with-langgraph-and-retrieval-augmented-generation" class="cell markdown" id="uIbfqYPZ8OLP">
<h1>Streaming AI-supported healthcare assistance platform with LangGraph and Retrieval-Augmented Generation</h1>
</section>
<div class="cell code" id="IRxyj_2F8M1y">
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" id="w8N8JtAx8B9w">
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="co"># Title</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a><span class="co">Agentic Healthcare customer support system using LangGraph with streaming and RAG-supported LLM Workflows</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a><span class="co"># Project overview:</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a><span class="co">Current healthcare support systems are used to solve a range of customers’ questions: from administrative questions to emergency medical queries.</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a><span class="co">First-generation chatbots which are used rule based tasks, can handle with semantic understanding and self-directed decision processes.</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a><span class="co">To overcome these limitations, agentic AI system is considered. It</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a><span class="co">•	Identifies user goals and emotions.</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a><span class="co">•	Incorporates RAG for accurate knowledge responses.</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a><span class="co">•	Dispatches user questions automatically with workflow decision graph.</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a><span class="co">•	Routes to human agents.</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true"></a><span class="co">•	Streams emergency medical operations</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true"></a><span class="co">•	Supports live and non-live LLM processing</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true"></a><span class="co"># Mission of the Project:</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true"></a><span class="co">The objective of this project (end-to-end Agentic AI pipelines with LLM) includes</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true"></a><span class="co">•	Tags healthcare customer questions.</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true"></a><span class="co">•	Interprets user feelings.</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true"></a><span class="co">•	Allocates queries based on context using a graph associated agent.</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true"></a><span class="co">•	Runs agents in live streaming approach for questions responses.</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true"></a><span class="co">•	Creates evidence-based results using RAG.</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true"></a><span class="co">•	Sends user questions to either human agent (or medical team).</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true"></a><span class="co"># Core tools:</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true"></a><span class="co">•	google.colab (Python) |</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true"></a><span class="co">•	Jupyter Widgets | LangChain | LangGraph | OpenAI (gpt-4o, LLM) GPT-4o.</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true"></a><span class="co">•	Vector Database (Chroma) | Prompt Engineering | TypedDict.</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true"></a><span class="co">•	Retrieval-Augmented Generation (RAG).</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true"></a><span class="co">•	Real time and planned LLM Tasks.</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true"></a><span class="co"># Notable Features:</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true"></a><span class="co">•	Multi-Agent graph framework</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true"></a><span class="co">•	Automated query sorting</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true"></a><span class="co">•	Emotion-sensitive routing</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true"></a><span class="co">•	RAG</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true"></a><span class="co">•	Human involved in the loop pipeline</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true"></a><span class="co">•	Urgent medical response workflow</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true"></a><span class="co">•	Online and offline performance</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true"></a><span class="co">•	Fully configured operational framework</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true"></a></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true"></a><span class="co"># Project file:</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true"></a><span class="co">Healthcare_Support_Agents_LangGraph_RAG_LLM_Pipelines.ipynb</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true"></a></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true"></a><span class="co">&quot;&quot;&quot;</span></span></code></pre></div>
</div>
<div class="cell code" id="vKVDFurT8CBL">
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<section id="load-llm-workflow-components-for-agentic-ai-systems-agentic-router-with-rag-and-sentiment-processing" class="cell markdown" id="5c_yZ0kDHSK6">
<h1>Load LLM workflow components for Agentic AI systems (Agentic router with RAG and Sentiment processing)</h1>
</section>
<div class="cell code" id="gN2dEdxQWbZP">
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="2" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="nS_UtkHsWpd0" data-outputId="bfc439e3-0f48-41e5-9be3-de841199a089">
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="op">!</span>pip install langchain<span class="op">==</span><span class="fl">0.3.21</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Requirement already satisfied: langchain==0.3.21 in /usr/local/lib/python3.12/dist-packages (0.3.21)
Requirement already satisfied: langchain-core&lt;1.0.0,&gt;=0.3.45 in /usr/local/lib/python3.12/dist-packages (from langchain==0.3.21) (0.3.83)
Requirement already satisfied: langchain-text-splitters&lt;1.0.0,&gt;=0.3.7 in /usr/local/lib/python3.12/dist-packages (from langchain==0.3.21) (0.3.11)
Requirement already satisfied: langsmith&lt;0.4,&gt;=0.1.17 in /usr/local/lib/python3.12/dist-packages (from langchain==0.3.21) (0.3.45)
Requirement already satisfied: pydantic&lt;3.0.0,&gt;=2.7.4 in /usr/local/lib/python3.12/dist-packages (from langchain==0.3.21) (2.12.3)
Requirement already satisfied: SQLAlchemy&lt;3,&gt;=1.4 in /usr/local/lib/python3.12/dist-packages (from langchain==0.3.21) (2.0.45)
Requirement already satisfied: requests&lt;3,&gt;=2 in /usr/local/lib/python3.12/dist-packages (from langchain==0.3.21) (2.32.4)
Requirement already satisfied: PyYAML&gt;=5.3 in /usr/local/lib/python3.12/dist-packages (from langchain==0.3.21) (6.0.3)
Requirement already satisfied: tenacity!=8.4.0,&lt;10.0.0,&gt;=8.1.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain==0.3.21) (9.1.2)
Requirement already satisfied: jsonpatch&lt;2.0.0,&gt;=1.33.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain==0.3.21) (1.33)
Requirement already satisfied: typing-extensions&lt;5.0.0,&gt;=4.7.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain==0.3.21) (4.15.0)
Requirement already satisfied: packaging&lt;26.0.0,&gt;=23.2.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain==0.3.21) (25.0)
Requirement already satisfied: uuid-utils&lt;1.0,&gt;=0.12.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain==0.3.21) (0.13.0)
Requirement already satisfied: httpx&lt;1,&gt;=0.23.0 in /usr/local/lib/python3.12/dist-packages (from langsmith&lt;0.4,&gt;=0.1.17-&gt;langchain==0.3.21) (0.28.1)
Requirement already satisfied: orjson&lt;4.0.0,&gt;=3.9.14 in /usr/local/lib/python3.12/dist-packages (from langsmith&lt;0.4,&gt;=0.1.17-&gt;langchain==0.3.21) (3.11.5)
Requirement already satisfied: requests-toolbelt&lt;2.0.0,&gt;=1.0.0 in /usr/local/lib/python3.12/dist-packages (from langsmith&lt;0.4,&gt;=0.1.17-&gt;langchain==0.3.21) (1.0.0)
Requirement already satisfied: zstandard&lt;0.24.0,&gt;=0.23.0 in /usr/local/lib/python3.12/dist-packages (from langsmith&lt;0.4,&gt;=0.1.17-&gt;langchain==0.3.21) (0.23.0)
Requirement already satisfied: annotated-types&gt;=0.6.0 in /usr/local/lib/python3.12/dist-packages (from pydantic&lt;3.0.0,&gt;=2.7.4-&gt;langchain==0.3.21) (0.7.0)
Requirement already satisfied: pydantic-core==2.41.4 in /usr/local/lib/python3.12/dist-packages (from pydantic&lt;3.0.0,&gt;=2.7.4-&gt;langchain==0.3.21) (2.41.4)
Requirement already satisfied: typing-inspection&gt;=0.4.2 in /usr/local/lib/python3.12/dist-packages (from pydantic&lt;3.0.0,&gt;=2.7.4-&gt;langchain==0.3.21) (0.4.2)
Requirement already satisfied: charset_normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.12/dist-packages (from requests&lt;3,&gt;=2-&gt;langchain==0.3.21) (3.4.4)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.12/dist-packages (from requests&lt;3,&gt;=2-&gt;langchain==0.3.21) (3.11)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/local/lib/python3.12/dist-packages (from requests&lt;3,&gt;=2-&gt;langchain==0.3.21) (2.5.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.12/dist-packages (from requests&lt;3,&gt;=2-&gt;langchain==0.3.21) (2026.1.4)
Requirement already satisfied: greenlet&gt;=1 in /usr/local/lib/python3.12/dist-packages (from SQLAlchemy&lt;3,&gt;=1.4-&gt;langchain==0.3.21) (3.3.0)
Requirement already satisfied: anyio in /usr/local/lib/python3.12/dist-packages (from httpx&lt;1,&gt;=0.23.0-&gt;langsmith&lt;0.4,&gt;=0.1.17-&gt;langchain==0.3.21) (4.12.1)
Requirement already satisfied: httpcore==1.* in /usr/local/lib/python3.12/dist-packages (from httpx&lt;1,&gt;=0.23.0-&gt;langsmith&lt;0.4,&gt;=0.1.17-&gt;langchain==0.3.21) (1.0.9)
Requirement already satisfied: h11&gt;=0.16 in /usr/local/lib/python3.12/dist-packages (from httpcore==1.*-&gt;httpx&lt;1,&gt;=0.23.0-&gt;langsmith&lt;0.4,&gt;=0.1.17-&gt;langchain==0.3.21) (0.16.0)
Requirement already satisfied: jsonpointer&gt;=1.9 in /usr/local/lib/python3.12/dist-packages (from jsonpatch&lt;2.0.0,&gt;=1.33.0-&gt;langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain==0.3.21) (3.0.0)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="3" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="n8Dkime4Wpga" data-outputId="08f81338-1663-46e6-a334-5544c263ea63">
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="op">!</span>pip install langchain<span class="op">-</span>community<span class="op">==</span><span class="fl">0.3.20</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Collecting langchain-community==0.3.20
  Downloading langchain_community-0.3.20-py3-none-any.whl.metadata (2.4 kB)
Requirement already satisfied: langchain-core&lt;1.0.0,&gt;=0.3.45 in /usr/local/lib/python3.12/dist-packages (from langchain-community==0.3.20) (0.3.83)
Requirement already satisfied: langchain&lt;1.0.0,&gt;=0.3.21 in /usr/local/lib/python3.12/dist-packages (from langchain-community==0.3.20) (0.3.21)
Requirement already satisfied: SQLAlchemy&lt;3,&gt;=1.4 in /usr/local/lib/python3.12/dist-packages (from langchain-community==0.3.20) (2.0.45)
Requirement already satisfied: requests&lt;3,&gt;=2 in /usr/local/lib/python3.12/dist-packages (from langchain-community==0.3.20) (2.32.4)
Requirement already satisfied: PyYAML&gt;=5.3 in /usr/local/lib/python3.12/dist-packages (from langchain-community==0.3.20) (6.0.3)
Requirement already satisfied: aiohttp&lt;4.0.0,&gt;=3.8.3 in /usr/local/lib/python3.12/dist-packages (from langchain-community==0.3.20) (3.13.3)
Requirement already satisfied: tenacity!=8.4.0,&lt;10,&gt;=8.1.0 in /usr/local/lib/python3.12/dist-packages (from langchain-community==0.3.20) (9.1.2)
Collecting dataclasses-json&lt;0.7,&gt;=0.5.7 (from langchain-community==0.3.20)
  Downloading dataclasses_json-0.6.7-py3-none-any.whl.metadata (25 kB)
Requirement already satisfied: pydantic-settings&lt;3.0.0,&gt;=2.4.0 in /usr/local/lib/python3.12/dist-packages (from langchain-community==0.3.20) (2.12.0)
Requirement already satisfied: langsmith&lt;0.4,&gt;=0.1.125 in /usr/local/lib/python3.12/dist-packages (from langchain-community==0.3.20) (0.3.45)
Requirement already satisfied: httpx-sse&lt;1.0.0,&gt;=0.4.0 in /usr/local/lib/python3.12/dist-packages (from langchain-community==0.3.20) (0.4.3)
Requirement already satisfied: numpy&lt;3,&gt;=1.26.2 in /usr/local/lib/python3.12/dist-packages (from langchain-community==0.3.20) (2.0.2)
Requirement already satisfied: aiohappyeyeballs&gt;=2.5.0 in /usr/local/lib/python3.12/dist-packages (from aiohttp&lt;4.0.0,&gt;=3.8.3-&gt;langchain-community==0.3.20) (2.6.1)
Requirement already satisfied: aiosignal&gt;=1.4.0 in /usr/local/lib/python3.12/dist-packages (from aiohttp&lt;4.0.0,&gt;=3.8.3-&gt;langchain-community==0.3.20) (1.4.0)
Requirement already satisfied: attrs&gt;=17.3.0 in /usr/local/lib/python3.12/dist-packages (from aiohttp&lt;4.0.0,&gt;=3.8.3-&gt;langchain-community==0.3.20) (25.4.0)
Requirement already satisfied: frozenlist&gt;=1.1.1 in /usr/local/lib/python3.12/dist-packages (from aiohttp&lt;4.0.0,&gt;=3.8.3-&gt;langchain-community==0.3.20) (1.8.0)
Requirement already satisfied: multidict&lt;7.0,&gt;=4.5 in /usr/local/lib/python3.12/dist-packages (from aiohttp&lt;4.0.0,&gt;=3.8.3-&gt;langchain-community==0.3.20) (6.7.0)
Requirement already satisfied: propcache&gt;=0.2.0 in /usr/local/lib/python3.12/dist-packages (from aiohttp&lt;4.0.0,&gt;=3.8.3-&gt;langchain-community==0.3.20) (0.4.1)
Requirement already satisfied: yarl&lt;2.0,&gt;=1.17.0 in /usr/local/lib/python3.12/dist-packages (from aiohttp&lt;4.0.0,&gt;=3.8.3-&gt;langchain-community==0.3.20) (1.22.0)
Collecting marshmallow&lt;4.0.0,&gt;=3.18.0 (from dataclasses-json&lt;0.7,&gt;=0.5.7-&gt;langchain-community==0.3.20)
  Downloading marshmallow-3.26.2-py3-none-any.whl.metadata (7.3 kB)
Collecting typing-inspect&lt;1,&gt;=0.4.0 (from dataclasses-json&lt;0.7,&gt;=0.5.7-&gt;langchain-community==0.3.20)
  Downloading typing_inspect-0.9.0-py3-none-any.whl.metadata (1.5 kB)
Requirement already satisfied: langchain-text-splitters&lt;1.0.0,&gt;=0.3.7 in /usr/local/lib/python3.12/dist-packages (from langchain&lt;1.0.0,&gt;=0.3.21-&gt;langchain-community==0.3.20) (0.3.11)
Requirement already satisfied: pydantic&lt;3.0.0,&gt;=2.7.4 in /usr/local/lib/python3.12/dist-packages (from langchain&lt;1.0.0,&gt;=0.3.21-&gt;langchain-community==0.3.20) (2.12.3)
Requirement already satisfied: jsonpatch&lt;2.0.0,&gt;=1.33.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain-community==0.3.20) (1.33)
Requirement already satisfied: typing-extensions&lt;5.0.0,&gt;=4.7.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain-community==0.3.20) (4.15.0)
Requirement already satisfied: packaging&lt;26.0.0,&gt;=23.2.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain-community==0.3.20) (25.0)
Requirement already satisfied: uuid-utils&lt;1.0,&gt;=0.12.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain-community==0.3.20) (0.13.0)
Requirement already satisfied: httpx&lt;1,&gt;=0.23.0 in /usr/local/lib/python3.12/dist-packages (from langsmith&lt;0.4,&gt;=0.1.125-&gt;langchain-community==0.3.20) (0.28.1)
Requirement already satisfied: orjson&lt;4.0.0,&gt;=3.9.14 in /usr/local/lib/python3.12/dist-packages (from langsmith&lt;0.4,&gt;=0.1.125-&gt;langchain-community==0.3.20) (3.11.5)
Requirement already satisfied: requests-toolbelt&lt;2.0.0,&gt;=1.0.0 in /usr/local/lib/python3.12/dist-packages (from langsmith&lt;0.4,&gt;=0.1.125-&gt;langchain-community==0.3.20) (1.0.0)
Requirement already satisfied: zstandard&lt;0.24.0,&gt;=0.23.0 in /usr/local/lib/python3.12/dist-packages (from langsmith&lt;0.4,&gt;=0.1.125-&gt;langchain-community==0.3.20) (0.23.0)
Requirement already satisfied: python-dotenv&gt;=0.21.0 in /usr/local/lib/python3.12/dist-packages (from pydantic-settings&lt;3.0.0,&gt;=2.4.0-&gt;langchain-community==0.3.20) (1.2.1)
Requirement already satisfied: typing-inspection&gt;=0.4.0 in /usr/local/lib/python3.12/dist-packages (from pydantic-settings&lt;3.0.0,&gt;=2.4.0-&gt;langchain-community==0.3.20) (0.4.2)
Requirement already satisfied: charset_normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.12/dist-packages (from requests&lt;3,&gt;=2-&gt;langchain-community==0.3.20) (3.4.4)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.12/dist-packages (from requests&lt;3,&gt;=2-&gt;langchain-community==0.3.20) (3.11)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/local/lib/python3.12/dist-packages (from requests&lt;3,&gt;=2-&gt;langchain-community==0.3.20) (2.5.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.12/dist-packages (from requests&lt;3,&gt;=2-&gt;langchain-community==0.3.20) (2026.1.4)
Requirement already satisfied: greenlet&gt;=1 in /usr/local/lib/python3.12/dist-packages (from SQLAlchemy&lt;3,&gt;=1.4-&gt;langchain-community==0.3.20) (3.3.0)
Requirement already satisfied: anyio in /usr/local/lib/python3.12/dist-packages (from httpx&lt;1,&gt;=0.23.0-&gt;langsmith&lt;0.4,&gt;=0.1.125-&gt;langchain-community==0.3.20) (4.12.1)
Requirement already satisfied: httpcore==1.* in /usr/local/lib/python3.12/dist-packages (from httpx&lt;1,&gt;=0.23.0-&gt;langsmith&lt;0.4,&gt;=0.1.125-&gt;langchain-community==0.3.20) (1.0.9)
Requirement already satisfied: h11&gt;=0.16 in /usr/local/lib/python3.12/dist-packages (from httpcore==1.*-&gt;httpx&lt;1,&gt;=0.23.0-&gt;langsmith&lt;0.4,&gt;=0.1.125-&gt;langchain-community==0.3.20) (0.16.0)
Requirement already satisfied: jsonpointer&gt;=1.9 in /usr/local/lib/python3.12/dist-packages (from jsonpatch&lt;2.0.0,&gt;=1.33.0-&gt;langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain-community==0.3.20) (3.0.0)
Requirement already satisfied: annotated-types&gt;=0.6.0 in /usr/local/lib/python3.12/dist-packages (from pydantic&lt;3.0.0,&gt;=2.7.4-&gt;langchain&lt;1.0.0,&gt;=0.3.21-&gt;langchain-community==0.3.20) (0.7.0)
Requirement already satisfied: pydantic-core==2.41.4 in /usr/local/lib/python3.12/dist-packages (from pydantic&lt;3.0.0,&gt;=2.7.4-&gt;langchain&lt;1.0.0,&gt;=0.3.21-&gt;langchain-community==0.3.20) (2.41.4)
Collecting mypy-extensions&gt;=0.3.0 (from typing-inspect&lt;1,&gt;=0.4.0-&gt;dataclasses-json&lt;0.7,&gt;=0.5.7-&gt;langchain-community==0.3.20)
  Downloading mypy_extensions-1.1.0-py3-none-any.whl.metadata (1.1 kB)
Downloading langchain_community-0.3.20-py3-none-any.whl (2.5 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.5/2.5 MB 29.7 MB/s eta 0:00:00
arshmallow-3.26.2-py3-none-any.whl (50 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 51.0/51.0 kB 3.6 MB/s eta 0:00:00
ypy_extensions-1.1.0-py3-none-any.whl (5.0 kB)
Installing collected packages: mypy-extensions, marshmallow, typing-inspect, dataclasses-json, langchain-community
Successfully installed dataclasses-json-0.6.7 langchain-community-0.3.20 marshmallow-3.26.2 mypy-extensions-1.1.0 typing-inspect-0.9.0
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="4" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="8KS-7ZIDWpkE" data-outputId="91d8cf0e-416b-469b-9ab8-644ec5f5f37b">
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="op">!</span>pip install langchain<span class="op">-</span>openai<span class="op">==</span><span class="fl">0.3.9</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Collecting langchain-openai==0.3.9
  Downloading langchain_openai-0.3.9-py3-none-any.whl.metadata (2.3 kB)
Requirement already satisfied: langchain-core&lt;1.0.0,&gt;=0.3.45 in /usr/local/lib/python3.12/dist-packages (from langchain-openai==0.3.9) (0.3.83)
Collecting openai&lt;2.0.0,&gt;=1.66.3 (from langchain-openai==0.3.9)
  Downloading openai-1.109.1-py3-none-any.whl.metadata (29 kB)
Requirement already satisfied: tiktoken&lt;1,&gt;=0.7 in /usr/local/lib/python3.12/dist-packages (from langchain-openai==0.3.9) (0.12.0)
Requirement already satisfied: langsmith&lt;1.0.0,&gt;=0.3.45 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain-openai==0.3.9) (0.3.45)
Requirement already satisfied: tenacity!=8.4.0,&lt;10.0.0,&gt;=8.1.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain-openai==0.3.9) (9.1.2)
Requirement already satisfied: jsonpatch&lt;2.0.0,&gt;=1.33.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain-openai==0.3.9) (1.33)
Requirement already satisfied: PyYAML&lt;7.0.0,&gt;=5.3.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain-openai==0.3.9) (6.0.3)
Requirement already satisfied: typing-extensions&lt;5.0.0,&gt;=4.7.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain-openai==0.3.9) (4.15.0)
Requirement already satisfied: packaging&lt;26.0.0,&gt;=23.2.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain-openai==0.3.9) (25.0)
Requirement already satisfied: pydantic&lt;3.0.0,&gt;=2.7.4 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain-openai==0.3.9) (2.12.3)
Requirement already satisfied: uuid-utils&lt;1.0,&gt;=0.12.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain-openai==0.3.9) (0.13.0)
Requirement already satisfied: anyio&lt;5,&gt;=3.5.0 in /usr/local/lib/python3.12/dist-packages (from openai&lt;2.0.0,&gt;=1.66.3-&gt;langchain-openai==0.3.9) (4.12.1)
Requirement already satisfied: distro&lt;2,&gt;=1.7.0 in /usr/local/lib/python3.12/dist-packages (from openai&lt;2.0.0,&gt;=1.66.3-&gt;langchain-openai==0.3.9) (1.9.0)
Requirement already satisfied: httpx&lt;1,&gt;=0.23.0 in /usr/local/lib/python3.12/dist-packages (from openai&lt;2.0.0,&gt;=1.66.3-&gt;langchain-openai==0.3.9) (0.28.1)
Requirement already satisfied: jiter&lt;1,&gt;=0.4.0 in /usr/local/lib/python3.12/dist-packages (from openai&lt;2.0.0,&gt;=1.66.3-&gt;langchain-openai==0.3.9) (0.12.0)
Requirement already satisfied: sniffio in /usr/local/lib/python3.12/dist-packages (from openai&lt;2.0.0,&gt;=1.66.3-&gt;langchain-openai==0.3.9) (1.3.1)
Requirement already satisfied: tqdm&gt;4 in /usr/local/lib/python3.12/dist-packages (from openai&lt;2.0.0,&gt;=1.66.3-&gt;langchain-openai==0.3.9) (4.67.1)
Requirement already satisfied: regex&gt;=2022.1.18 in /usr/local/lib/python3.12/dist-packages (from tiktoken&lt;1,&gt;=0.7-&gt;langchain-openai==0.3.9) (2025.11.3)
Requirement already satisfied: requests&gt;=2.26.0 in /usr/local/lib/python3.12/dist-packages (from tiktoken&lt;1,&gt;=0.7-&gt;langchain-openai==0.3.9) (2.32.4)
Requirement already satisfied: idna&gt;=2.8 in /usr/local/lib/python3.12/dist-packages (from anyio&lt;5,&gt;=3.5.0-&gt;openai&lt;2.0.0,&gt;=1.66.3-&gt;langchain-openai==0.3.9) (3.11)
Requirement already satisfied: certifi in /usr/local/lib/python3.12/dist-packages (from httpx&lt;1,&gt;=0.23.0-&gt;openai&lt;2.0.0,&gt;=1.66.3-&gt;langchain-openai==0.3.9) (2026.1.4)
Requirement already satisfied: httpcore==1.* in /usr/local/lib/python3.12/dist-packages (from httpx&lt;1,&gt;=0.23.0-&gt;openai&lt;2.0.0,&gt;=1.66.3-&gt;langchain-openai==0.3.9) (1.0.9)
Requirement already satisfied: h11&gt;=0.16 in /usr/local/lib/python3.12/dist-packages (from httpcore==1.*-&gt;httpx&lt;1,&gt;=0.23.0-&gt;openai&lt;2.0.0,&gt;=1.66.3-&gt;langchain-openai==0.3.9) (0.16.0)
Requirement already satisfied: jsonpointer&gt;=1.9 in /usr/local/lib/python3.12/dist-packages (from jsonpatch&lt;2.0.0,&gt;=1.33.0-&gt;langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain-openai==0.3.9) (3.0.0)
Requirement already satisfied: orjson&lt;4.0.0,&gt;=3.9.14 in /usr/local/lib/python3.12/dist-packages (from langsmith&lt;1.0.0,&gt;=0.3.45-&gt;langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain-openai==0.3.9) (3.11.5)
Requirement already satisfied: requests-toolbelt&lt;2.0.0,&gt;=1.0.0 in /usr/local/lib/python3.12/dist-packages (from langsmith&lt;1.0.0,&gt;=0.3.45-&gt;langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain-openai==0.3.9) (1.0.0)
Requirement already satisfied: zstandard&lt;0.24.0,&gt;=0.23.0 in /usr/local/lib/python3.12/dist-packages (from langsmith&lt;1.0.0,&gt;=0.3.45-&gt;langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain-openai==0.3.9) (0.23.0)
Requirement already satisfied: annotated-types&gt;=0.6.0 in /usr/local/lib/python3.12/dist-packages (from pydantic&lt;3.0.0,&gt;=2.7.4-&gt;langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain-openai==0.3.9) (0.7.0)
Requirement already satisfied: pydantic-core==2.41.4 in /usr/local/lib/python3.12/dist-packages (from pydantic&lt;3.0.0,&gt;=2.7.4-&gt;langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain-openai==0.3.9) (2.41.4)
Requirement already satisfied: typing-inspection&gt;=0.4.2 in /usr/local/lib/python3.12/dist-packages (from pydantic&lt;3.0.0,&gt;=2.7.4-&gt;langchain-core&lt;1.0.0,&gt;=0.3.45-&gt;langchain-openai==0.3.9) (0.4.2)
Requirement already satisfied: charset_normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.12/dist-packages (from requests&gt;=2.26.0-&gt;tiktoken&lt;1,&gt;=0.7-&gt;langchain-openai==0.3.9) (3.4.4)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/local/lib/python3.12/dist-packages (from requests&gt;=2.26.0-&gt;tiktoken&lt;1,&gt;=0.7-&gt;langchain-openai==0.3.9) (2.5.0)
Downloading langchain_openai-0.3.9-py3-none-any.whl (60 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 60.9/60.9 kB 4.0 MB/s eta 0:00:00
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 948.6/948.6 kB 18.4 MB/s eta 0:00:00
pting uninstall: openai
    Found existing installation: openai 2.14.0
    Uninstalling openai-2.14.0:
      Successfully uninstalled openai-2.14.0
Successfully installed langchain-openai-0.3.9 openai-1.109.1
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="5" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="QPIjaX3ZW5pC" data-outputId="27b96487-b205-473d-d9f4-14036796dccb">
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="op">!</span>pip install langgraph<span class="op">==</span><span class="fl">0.3.18</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Collecting langgraph==0.3.18
  Downloading langgraph-0.3.18-py3-none-any.whl.metadata (7.5 kB)
Requirement already satisfied: langchain-core&lt;0.4,&gt;=0.1 in /usr/local/lib/python3.12/dist-packages (from langgraph==0.3.18) (0.3.83)
Collecting langgraph-checkpoint&lt;3.0.0,&gt;=2.0.10 (from langgraph==0.3.18)
  Downloading langgraph_checkpoint-2.1.2-py3-none-any.whl.metadata (4.2 kB)
Collecting langgraph-prebuilt&lt;0.2,&gt;=0.1.1 (from langgraph==0.3.18)
  Downloading langgraph_prebuilt-0.1.8-py3-none-any.whl.metadata (5.0 kB)
Collecting langgraph-sdk&lt;0.2.0,&gt;=0.1.42 (from langgraph==0.3.18)
  Downloading langgraph_sdk-0.1.74-py3-none-any.whl.metadata (1.5 kB)
Requirement already satisfied: langsmith&lt;1.0.0,&gt;=0.3.45 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;0.4,&gt;=0.1-&gt;langgraph==0.3.18) (0.3.45)
Requirement already satisfied: tenacity!=8.4.0,&lt;10.0.0,&gt;=8.1.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;0.4,&gt;=0.1-&gt;langgraph==0.3.18) (9.1.2)
Requirement already satisfied: jsonpatch&lt;2.0.0,&gt;=1.33.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;0.4,&gt;=0.1-&gt;langgraph==0.3.18) (1.33)
Requirement already satisfied: PyYAML&lt;7.0.0,&gt;=5.3.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;0.4,&gt;=0.1-&gt;langgraph==0.3.18) (6.0.3)
Requirement already satisfied: typing-extensions&lt;5.0.0,&gt;=4.7.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;0.4,&gt;=0.1-&gt;langgraph==0.3.18) (4.15.0)
Requirement already satisfied: packaging&lt;26.0.0,&gt;=23.2.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;0.4,&gt;=0.1-&gt;langgraph==0.3.18) (25.0)
Requirement already satisfied: pydantic&lt;3.0.0,&gt;=2.7.4 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;0.4,&gt;=0.1-&gt;langgraph==0.3.18) (2.12.3)
Requirement already satisfied: uuid-utils&lt;1.0,&gt;=0.12.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core&lt;0.4,&gt;=0.1-&gt;langgraph==0.3.18) (0.13.0)
Requirement already satisfied: ormsgpack&gt;=1.10.0 in /usr/local/lib/python3.12/dist-packages (from langgraph-checkpoint&lt;3.0.0,&gt;=2.0.10-&gt;langgraph==0.3.18) (1.12.1)
Requirement already satisfied: httpx&gt;=0.25.2 in /usr/local/lib/python3.12/dist-packages (from langgraph-sdk&lt;0.2.0,&gt;=0.1.42-&gt;langgraph==0.3.18) (0.28.1)
Requirement already satisfied: orjson&gt;=3.10.1 in /usr/local/lib/python3.12/dist-packages (from langgraph-sdk&lt;0.2.0,&gt;=0.1.42-&gt;langgraph==0.3.18) (3.11.5)
Requirement already satisfied: anyio in /usr/local/lib/python3.12/dist-packages (from httpx&gt;=0.25.2-&gt;langgraph-sdk&lt;0.2.0,&gt;=0.1.42-&gt;langgraph==0.3.18) (4.12.1)
Requirement already satisfied: certifi in /usr/local/lib/python3.12/dist-packages (from httpx&gt;=0.25.2-&gt;langgraph-sdk&lt;0.2.0,&gt;=0.1.42-&gt;langgraph==0.3.18) (2026.1.4)
Requirement already satisfied: httpcore==1.* in /usr/local/lib/python3.12/dist-packages (from httpx&gt;=0.25.2-&gt;langgraph-sdk&lt;0.2.0,&gt;=0.1.42-&gt;langgraph==0.3.18) (1.0.9)
Requirement already satisfied: idna in /usr/local/lib/python3.12/dist-packages (from httpx&gt;=0.25.2-&gt;langgraph-sdk&lt;0.2.0,&gt;=0.1.42-&gt;langgraph==0.3.18) (3.11)
Requirement already satisfied: h11&gt;=0.16 in /usr/local/lib/python3.12/dist-packages (from httpcore==1.*-&gt;httpx&gt;=0.25.2-&gt;langgraph-sdk&lt;0.2.0,&gt;=0.1.42-&gt;langgraph==0.3.18) (0.16.0)
Requirement already satisfied: jsonpointer&gt;=1.9 in /usr/local/lib/python3.12/dist-packages (from jsonpatch&lt;2.0.0,&gt;=1.33.0-&gt;langchain-core&lt;0.4,&gt;=0.1-&gt;langgraph==0.3.18) (3.0.0)
Requirement already satisfied: requests&lt;3,&gt;=2 in /usr/local/lib/python3.12/dist-packages (from langsmith&lt;1.0.0,&gt;=0.3.45-&gt;langchain-core&lt;0.4,&gt;=0.1-&gt;langgraph==0.3.18) (2.32.4)
Requirement already satisfied: requests-toolbelt&lt;2.0.0,&gt;=1.0.0 in /usr/local/lib/python3.12/dist-packages (from langsmith&lt;1.0.0,&gt;=0.3.45-&gt;langchain-core&lt;0.4,&gt;=0.1-&gt;langgraph==0.3.18) (1.0.0)
Requirement already satisfied: zstandard&lt;0.24.0,&gt;=0.23.0 in /usr/local/lib/python3.12/dist-packages (from langsmith&lt;1.0.0,&gt;=0.3.45-&gt;langchain-core&lt;0.4,&gt;=0.1-&gt;langgraph==0.3.18) (0.23.0)
Requirement already satisfied: annotated-types&gt;=0.6.0 in /usr/local/lib/python3.12/dist-packages (from pydantic&lt;3.0.0,&gt;=2.7.4-&gt;langchain-core&lt;0.4,&gt;=0.1-&gt;langgraph==0.3.18) (0.7.0)
Requirement already satisfied: pydantic-core==2.41.4 in /usr/local/lib/python3.12/dist-packages (from pydantic&lt;3.0.0,&gt;=2.7.4-&gt;langchain-core&lt;0.4,&gt;=0.1-&gt;langgraph==0.3.18) (2.41.4)
Requirement already satisfied: typing-inspection&gt;=0.4.2 in /usr/local/lib/python3.12/dist-packages (from pydantic&lt;3.0.0,&gt;=2.7.4-&gt;langchain-core&lt;0.4,&gt;=0.1-&gt;langgraph==0.3.18) (0.4.2)
Requirement already satisfied: charset_normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.12/dist-packages (from requests&lt;3,&gt;=2-&gt;langsmith&lt;1.0.0,&gt;=0.3.45-&gt;langchain-core&lt;0.4,&gt;=0.1-&gt;langgraph==0.3.18) (3.4.4)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/local/lib/python3.12/dist-packages (from requests&lt;3,&gt;=2-&gt;langsmith&lt;1.0.0,&gt;=0.3.45-&gt;langchain-core&lt;0.4,&gt;=0.1-&gt;langgraph==0.3.18) (2.5.0)
Downloading langgraph-0.3.18-py3-none-any.whl (136 kB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 136.5/136.5 kB 3.3 MB/s eta 0:00:00
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 45.8/45.8 kB 3.7 MB/s eta 0:00:00
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 50.3/50.3 kB 3.6 MB/s eta 0:00:00
pting uninstall: langgraph-sdk
    Found existing installation: langgraph-sdk 0.3.1
    Uninstalling langgraph-sdk-0.3.1:
      Successfully uninstalled langgraph-sdk-0.3.1
  Attempting uninstall: langgraph-checkpoint
    Found existing installation: langgraph-checkpoint 3.0.1
    Uninstalling langgraph-checkpoint-3.0.1:
      Successfully uninstalled langgraph-checkpoint-3.0.1
  Attempting uninstall: langgraph-prebuilt
    Found existing installation: langgraph-prebuilt 1.0.5
    Uninstalling langgraph-prebuilt-1.0.5:
      Successfully uninstalled langgraph-prebuilt-1.0.5
  Attempting uninstall: langgraph
    Found existing installation: langgraph 1.0.5
    Uninstalling langgraph-1.0.5:
      Successfully uninstalled langgraph-1.0.5
Successfully installed langgraph-0.3.18 langgraph-checkpoint-2.1.2 langgraph-prebuilt-0.1.8 langgraph-sdk-0.1.74
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="6" id="XPiUhKYq0J6X">
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="im">import</span> langchain</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="7" id="H5L_WUWV0PJM">
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a><span class="im">import</span> langchain_community</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="8" id="60sbqdHVXhQ_">
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="im">import</span> langchain_openai</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="10" id="ohXn2RQhXhUd">
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a><span class="im">import</span> langgraph</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="1" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="JZiZJVuN-_ag" data-outputId="912b3d75-6f42-4956-d9fd-426feb15f45c">
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a><span class="op">!</span>pip install langchain<span class="op">-</span>chroma<span class="op">==</span><span class="fl">0.2.2</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Requirement already satisfied: langchain-chroma==0.2.2 in /usr/local/lib/python3.12/dist-packages (0.2.2)
Requirement already satisfied: langchain-core!=0.3.0,!=0.3.1,!=0.3.10,!=0.3.11,!=0.3.12,!=0.3.13,!=0.3.14,!=0.3.2,!=0.3.3,!=0.3.4,!=0.3.5,!=0.3.6,!=0.3.7,!=0.3.8,!=0.3.9,&lt;0.4.0,&gt;=0.2.43 in /usr/local/lib/python3.12/dist-packages (from langchain-chroma==0.2.2) (0.3.83)
Requirement already satisfied: numpy&lt;2.0.0,&gt;=1.26.2 in /usr/local/lib/python3.12/dist-packages (from langchain-chroma==0.2.2) (1.26.4)
Requirement already satisfied: chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0 in /usr/local/lib/python3.12/dist-packages (from langchain-chroma==0.2.2) (0.6.3)
Requirement already satisfied: build&gt;=1.0.3 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (1.4.0)
Requirement already satisfied: pydantic&gt;=1.9 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (2.12.3)
Requirement already satisfied: chroma-hnswlib==0.7.6 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.7.6)
Requirement already satisfied: fastapi&gt;=0.95.2 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.123.10)
Requirement already satisfied: uvicorn&gt;=0.18.3 in /usr/local/lib/python3.12/dist-packages (from uvicorn[standard]&gt;=0.18.3-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.40.0)
Requirement already satisfied: posthog&gt;=2.4.0 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (7.6.0)
Requirement already satisfied: typing_extensions&gt;=4.5.0 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (4.15.0)
Requirement already satisfied: onnxruntime&gt;=1.14.1 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (1.23.2)
Requirement already satisfied: opentelemetry-api&gt;=1.2.0 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (1.39.1)
Requirement already satisfied: opentelemetry-exporter-otlp-proto-grpc&gt;=1.2.0 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (1.39.1)
Requirement already satisfied: opentelemetry-instrumentation-fastapi&gt;=0.41b0 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.60b1)
Requirement already satisfied: opentelemetry-sdk&gt;=1.2.0 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (1.39.1)
Requirement already satisfied: tokenizers&gt;=0.13.2 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.22.2)
Requirement already satisfied: pypika&gt;=0.48.9 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.50.0)
Requirement already satisfied: tqdm&gt;=4.65.0 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (4.67.1)
Requirement already satisfied: overrides&gt;=7.3.1 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (7.7.0)
Requirement already satisfied: importlib-resources in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (6.5.2)
Requirement already satisfied: grpcio&gt;=1.58.0 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (1.76.0)
Requirement already satisfied: bcrypt&gt;=4.0.1 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (5.0.0)
Requirement already satisfied: typer&gt;=0.9.0 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.21.1)
Requirement already satisfied: kubernetes&gt;=28.1.0 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (35.0.0)
Requirement already satisfied: tenacity&gt;=8.2.3 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (9.1.2)
Requirement already satisfied: PyYAML&gt;=6.0.0 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (6.0.3)
Requirement already satisfied: mmh3&gt;=4.0.1 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (5.2.0)
Requirement already satisfied: orjson&gt;=3.9.12 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (3.11.5)
Requirement already satisfied: httpx&gt;=0.27.0 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.28.1)
Requirement already satisfied: rich&gt;=10.11.0 in /usr/local/lib/python3.12/dist-packages (from chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (13.9.4)
Requirement already satisfied: langsmith&lt;1.0.0,&gt;=0.3.45 in /usr/local/lib/python3.12/dist-packages (from langchain-core!=0.3.0,!=0.3.1,!=0.3.10,!=0.3.11,!=0.3.12,!=0.3.13,!=0.3.14,!=0.3.2,!=0.3.3,!=0.3.4,!=0.3.5,!=0.3.6,!=0.3.7,!=0.3.8,!=0.3.9,&lt;0.4.0,&gt;=0.2.43-&gt;langchain-chroma==0.2.2) (0.3.45)
Requirement already satisfied: jsonpatch&lt;2.0.0,&gt;=1.33.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core!=0.3.0,!=0.3.1,!=0.3.10,!=0.3.11,!=0.3.12,!=0.3.13,!=0.3.14,!=0.3.2,!=0.3.3,!=0.3.4,!=0.3.5,!=0.3.6,!=0.3.7,!=0.3.8,!=0.3.9,&lt;0.4.0,&gt;=0.2.43-&gt;langchain-chroma==0.2.2) (1.33)
Requirement already satisfied: packaging&lt;26.0.0,&gt;=23.2.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core!=0.3.0,!=0.3.1,!=0.3.10,!=0.3.11,!=0.3.12,!=0.3.13,!=0.3.14,!=0.3.2,!=0.3.3,!=0.3.4,!=0.3.5,!=0.3.6,!=0.3.7,!=0.3.8,!=0.3.9,&lt;0.4.0,&gt;=0.2.43-&gt;langchain-chroma==0.2.2) (25.0)
Requirement already satisfied: uuid-utils&lt;1.0,&gt;=0.12.0 in /usr/local/lib/python3.12/dist-packages (from langchain-core!=0.3.0,!=0.3.1,!=0.3.10,!=0.3.11,!=0.3.12,!=0.3.13,!=0.3.14,!=0.3.2,!=0.3.3,!=0.3.4,!=0.3.5,!=0.3.6,!=0.3.7,!=0.3.8,!=0.3.9,&lt;0.4.0,&gt;=0.2.43-&gt;langchain-chroma==0.2.2) (0.13.0)
Requirement already satisfied: pyproject_hooks in /usr/local/lib/python3.12/dist-packages (from build&gt;=1.0.3-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (1.2.0)
Requirement already satisfied: starlette&lt;0.51.0,&gt;=0.40.0 in /usr/local/lib/python3.12/dist-packages (from fastapi&gt;=0.95.2-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.50.0)
Requirement already satisfied: annotated-doc&gt;=0.0.2 in /usr/local/lib/python3.12/dist-packages (from fastapi&gt;=0.95.2-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.0.4)
Requirement already satisfied: anyio in /usr/local/lib/python3.12/dist-packages (from httpx&gt;=0.27.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (4.12.1)
Requirement already satisfied: certifi in /usr/local/lib/python3.12/dist-packages (from httpx&gt;=0.27.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (2026.1.4)
Requirement already satisfied: httpcore==1.* in /usr/local/lib/python3.12/dist-packages (from httpx&gt;=0.27.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (1.0.9)
Requirement already satisfied: idna in /usr/local/lib/python3.12/dist-packages (from httpx&gt;=0.27.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (3.11)
Requirement already satisfied: h11&gt;=0.16 in /usr/local/lib/python3.12/dist-packages (from httpcore==1.*-&gt;httpx&gt;=0.27.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.16.0)
Requirement already satisfied: jsonpointer&gt;=1.9 in /usr/local/lib/python3.12/dist-packages (from jsonpatch&lt;2.0.0,&gt;=1.33.0-&gt;langchain-core!=0.3.0,!=0.3.1,!=0.3.10,!=0.3.11,!=0.3.12,!=0.3.13,!=0.3.14,!=0.3.2,!=0.3.3,!=0.3.4,!=0.3.5,!=0.3.6,!=0.3.7,!=0.3.8,!=0.3.9,&lt;0.4.0,&gt;=0.2.43-&gt;langchain-chroma==0.2.2) (3.0.0)
Requirement already satisfied: six&gt;=1.9.0 in /usr/local/lib/python3.12/dist-packages (from kubernetes&gt;=28.1.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (1.17.0)
Requirement already satisfied: python-dateutil&gt;=2.5.3 in /usr/local/lib/python3.12/dist-packages (from kubernetes&gt;=28.1.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (2.9.0.post0)
Requirement already satisfied: websocket-client!=0.40.0,!=0.41.*,!=0.42.*,&gt;=0.32.0 in /usr/local/lib/python3.12/dist-packages (from kubernetes&gt;=28.1.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (1.9.0)
Requirement already satisfied: requests in /usr/local/lib/python3.12/dist-packages (from kubernetes&gt;=28.1.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (2.32.4)
Requirement already satisfied: requests-oauthlib in /usr/local/lib/python3.12/dist-packages (from kubernetes&gt;=28.1.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (2.0.0)
Requirement already satisfied: urllib3!=2.6.0,&gt;=1.24.2 in /usr/local/lib/python3.12/dist-packages (from kubernetes&gt;=28.1.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (2.5.0)
Requirement already satisfied: durationpy&gt;=0.7 in /usr/local/lib/python3.12/dist-packages (from kubernetes&gt;=28.1.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.10)
Requirement already satisfied: requests-toolbelt&lt;2.0.0,&gt;=1.0.0 in /usr/local/lib/python3.12/dist-packages (from langsmith&lt;1.0.0,&gt;=0.3.45-&gt;langchain-core!=0.3.0,!=0.3.1,!=0.3.10,!=0.3.11,!=0.3.12,!=0.3.13,!=0.3.14,!=0.3.2,!=0.3.3,!=0.3.4,!=0.3.5,!=0.3.6,!=0.3.7,!=0.3.8,!=0.3.9,&lt;0.4.0,&gt;=0.2.43-&gt;langchain-chroma==0.2.2) (1.0.0)
Requirement already satisfied: zstandard&lt;0.24.0,&gt;=0.23.0 in /usr/local/lib/python3.12/dist-packages (from langsmith&lt;1.0.0,&gt;=0.3.45-&gt;langchain-core!=0.3.0,!=0.3.1,!=0.3.10,!=0.3.11,!=0.3.12,!=0.3.13,!=0.3.14,!=0.3.2,!=0.3.3,!=0.3.4,!=0.3.5,!=0.3.6,!=0.3.7,!=0.3.8,!=0.3.9,&lt;0.4.0,&gt;=0.2.43-&gt;langchain-chroma==0.2.2) (0.23.0)
Requirement already satisfied: coloredlogs in /usr/local/lib/python3.12/dist-packages (from onnxruntime&gt;=1.14.1-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (15.0.1)
Requirement already satisfied: flatbuffers in /usr/local/lib/python3.12/dist-packages (from onnxruntime&gt;=1.14.1-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (25.12.19)
Requirement already satisfied: protobuf in /usr/local/lib/python3.12/dist-packages (from onnxruntime&gt;=1.14.1-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (5.29.5)
Requirement already satisfied: sympy in /usr/local/lib/python3.12/dist-packages (from onnxruntime&gt;=1.14.1-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (1.14.0)
Requirement already satisfied: importlib-metadata&lt;8.8.0,&gt;=6.0 in /usr/local/lib/python3.12/dist-packages (from opentelemetry-api&gt;=1.2.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (8.7.1)
Requirement already satisfied: googleapis-common-protos~=1.57 in /usr/local/lib/python3.12/dist-packages (from opentelemetry-exporter-otlp-proto-grpc&gt;=1.2.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (1.72.0)
Requirement already satisfied: opentelemetry-exporter-otlp-proto-common==1.39.1 in /usr/local/lib/python3.12/dist-packages (from opentelemetry-exporter-otlp-proto-grpc&gt;=1.2.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (1.39.1)
Requirement already satisfied: opentelemetry-proto==1.39.1 in /usr/local/lib/python3.12/dist-packages (from opentelemetry-exporter-otlp-proto-grpc&gt;=1.2.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (1.39.1)
Requirement already satisfied: opentelemetry-instrumentation-asgi==0.60b1 in /usr/local/lib/python3.12/dist-packages (from opentelemetry-instrumentation-fastapi&gt;=0.41b0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.60b1)
Requirement already satisfied: opentelemetry-instrumentation==0.60b1 in /usr/local/lib/python3.12/dist-packages (from opentelemetry-instrumentation-fastapi&gt;=0.41b0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.60b1)
Requirement already satisfied: opentelemetry-semantic-conventions==0.60b1 in /usr/local/lib/python3.12/dist-packages (from opentelemetry-instrumentation-fastapi&gt;=0.41b0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.60b1)
Requirement already satisfied: opentelemetry-util-http==0.60b1 in /usr/local/lib/python3.12/dist-packages (from opentelemetry-instrumentation-fastapi&gt;=0.41b0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.60b1)
Requirement already satisfied: wrapt&lt;2.0.0,&gt;=1.0.0 in /usr/local/lib/python3.12/dist-packages (from opentelemetry-instrumentation==0.60b1-&gt;opentelemetry-instrumentation-fastapi&gt;=0.41b0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (1.17.3)
Requirement already satisfied: asgiref~=3.0 in /usr/local/lib/python3.12/dist-packages (from opentelemetry-instrumentation-asgi==0.60b1-&gt;opentelemetry-instrumentation-fastapi&gt;=0.41b0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (3.11.0)
Requirement already satisfied: backoff&gt;=1.10.0 in /usr/local/lib/python3.12/dist-packages (from posthog&gt;=2.4.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (2.2.1)
Requirement already satisfied: distro&gt;=1.5.0 in /usr/local/lib/python3.12/dist-packages (from posthog&gt;=2.4.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (1.9.0)
Requirement already satisfied: annotated-types&gt;=0.6.0 in /usr/local/lib/python3.12/dist-packages (from pydantic&gt;=1.9-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.7.0)
Requirement already satisfied: pydantic-core==2.41.4 in /usr/local/lib/python3.12/dist-packages (from pydantic&gt;=1.9-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (2.41.4)
Requirement already satisfied: typing-inspection&gt;=0.4.2 in /usr/local/lib/python3.12/dist-packages (from pydantic&gt;=1.9-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.4.2)
Requirement already satisfied: markdown-it-py&gt;=2.2.0 in /usr/local/lib/python3.12/dist-packages (from rich&gt;=10.11.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (4.0.0)
Requirement already satisfied: pygments&lt;3.0.0,&gt;=2.13.0 in /usr/local/lib/python3.12/dist-packages (from rich&gt;=10.11.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (2.19.2)
Requirement already satisfied: huggingface-hub&lt;2.0,&gt;=0.16.4 in /usr/local/lib/python3.12/dist-packages (from tokenizers&gt;=0.13.2-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.36.0)
Requirement already satisfied: click&gt;=8.0.0 in /usr/local/lib/python3.12/dist-packages (from typer&gt;=0.9.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (8.3.1)
Requirement already satisfied: shellingham&gt;=1.3.0 in /usr/local/lib/python3.12/dist-packages (from typer&gt;=0.9.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (1.5.4)
Requirement already satisfied: httptools&gt;=0.6.3 in /usr/local/lib/python3.12/dist-packages (from uvicorn[standard]&gt;=0.18.3-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.7.1)
Requirement already satisfied: python-dotenv&gt;=0.13 in /usr/local/lib/python3.12/dist-packages (from uvicorn[standard]&gt;=0.18.3-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (1.2.1)
Requirement already satisfied: uvloop&gt;=0.15.1 in /usr/local/lib/python3.12/dist-packages (from uvicorn[standard]&gt;=0.18.3-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.22.1)
Requirement already satisfied: watchfiles&gt;=0.13 in /usr/local/lib/python3.12/dist-packages (from uvicorn[standard]&gt;=0.18.3-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (1.1.1)
Requirement already satisfied: websockets&gt;=10.4 in /usr/local/lib/python3.12/dist-packages (from uvicorn[standard]&gt;=0.18.3-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (15.0.1)
Requirement already satisfied: filelock in /usr/local/lib/python3.12/dist-packages (from huggingface-hub&lt;2.0,&gt;=0.16.4-&gt;tokenizers&gt;=0.13.2-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (3.20.2)
Requirement already satisfied: fsspec&gt;=2023.5.0 in /usr/local/lib/python3.12/dist-packages (from huggingface-hub&lt;2.0,&gt;=0.16.4-&gt;tokenizers&gt;=0.13.2-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (2025.3.0)
Requirement already satisfied: hf-xet&lt;2.0.0,&gt;=1.1.3 in /usr/local/lib/python3.12/dist-packages (from huggingface-hub&lt;2.0,&gt;=0.16.4-&gt;tokenizers&gt;=0.13.2-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (1.2.0)
Requirement already satisfied: zipp&gt;=3.20 in /usr/local/lib/python3.12/dist-packages (from importlib-metadata&lt;8.8.0,&gt;=6.0-&gt;opentelemetry-api&gt;=1.2.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (3.23.0)
Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.12/dist-packages (from markdown-it-py&gt;=2.2.0-&gt;rich&gt;=10.11.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (0.1.2)
Requirement already satisfied: charset_normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.12/dist-packages (from requests-&gt;kubernetes&gt;=28.1.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (3.4.4)
Requirement already satisfied: humanfriendly&gt;=9.1 in /usr/local/lib/python3.12/dist-packages (from coloredlogs-&gt;onnxruntime&gt;=1.14.1-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (10.0)
Requirement already satisfied: oauthlib&gt;=3.0.0 in /usr/local/lib/python3.12/dist-packages (from requests-oauthlib-&gt;kubernetes&gt;=28.1.0-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (3.3.1)
Requirement already satisfied: mpmath&lt;1.4,&gt;=1.1.0 in /usr/local/lib/python3.12/dist-packages (from sympy-&gt;onnxruntime&gt;=1.14.1-&gt;chromadb!=0.5.10,!=0.5.11,!=0.5.12,!=0.5.4,!=0.5.5,!=0.5.7,!=0.5.9,&lt;0.7.0,&gt;=0.4.0-&gt;langchain-chroma==0.2.2) (1.3.0)
</code></pre>
</div>
</div>
<div class="cell code" id="SG97dbVC-_vb">
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" id="dBKT8-jtXpCM">
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="3" id="FMMEn6CIInPx">
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="im">import</span> os</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="4" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="81MNJYsnInTM" data-outputId="fbed7022-3dc2-43dd-ba5f-8472fdd5a778">
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a><span class="im">from</span> getpass <span class="im">import</span> getpass</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true"></a>os.environ[<span class="st">&#39;OPENAI_API_KEY&#39;</span>] <span class="op">=</span> getpass(<span class="st">&#39;put OpenAI API key: &#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>put OpenAI API key: ··········
</code></pre>
</div>
</div>
<section id="load-information-from-outside-files-from-where-the-ai-can-answer-user-questions" class="cell markdown" id="kQf8mXxqJX64">
<h1>Load information from outside files from where the AI can answer user questions</h1>
</section>
<div class="cell code" id="jrYvOaC14WI9">
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="5" id="GF_n-y4XSFhW">
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a><span class="op">!</span>pip install <span class="op">--</span>quiet gdown</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="6" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="Y3PUVTy3U_9Q" data-outputId="cc2c08c6-ebc5-486c-dd40-baa91d34f47d">
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a><span class="co"># Load healthcare knowledge base (KB) documents</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true"></a><span class="op">!</span>gdown 1_bQj7VkXDMwwqJmspFgRzH2mgK1CVMUY</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Downloading...
From: https://drive.google.com/uc?id=1_bQj7VkXDMwwqJmspFgRzH2mgK1CVMUY
To: /content/healthcare_db.json
  0% 0.00/10.6k [00:00&lt;?, ?B/s]100% 10.6k/10.6k [00:00&lt;00:00, 17.4MB/s]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="7" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="3d380thVawV4" data-outputId="c48f9de2-f6bc-40eb-ad3d-54e433320851">
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a><span class="co"># Load information from a JSON file. AI can answer user questions using company data.</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true"></a><span class="im">import</span> json</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;./healthcare_db.json&#39;</span>, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> read:</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true"></a>  external_data  <span class="op">=</span> json.load(read)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true"></a>external_data[:<span class="dv">3</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="7">
<pre><code>[{&#39;text&#39;: &quot;Question: How can I view my healthcare billing statement online? Answer: You can view your billing statement by logging into your patient portal and selecting &#39;Billing Statements&#39;.&quot;,
  &#39;metadata&#39;: {&#39;category&#39;: &#39;billing&#39;}},
 {&#39;text&#39;: &#39;Question: What payment methods are accepted for medical bills? Answer: We accept credit cards, bank transfers, and insurance payments for settling your medical bills.&#39;,
  &#39;metadata&#39;: {&#39;category&#39;: &#39;billing&#39;}},
 {&#39;text&#39;: &#39;Question: Can I get a detailed invoice for my medical services? Answer: Yes, a detailed invoice is available in your patient portal under the billing section.&#39;,
  &#39;metadata&#39;: {&#39;category&#39;: &#39;billing&#39;}}]</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="8" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="0ShSOQwKbr5k" data-outputId="967d414a-545a-4bad-b707-899039786709">
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true"></a>external_data[<span class="dv">10</span>:<span class="dv">13</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="8">
<pre><code>[{&#39;text&#39;: &#39;Question: How do I schedule a medical appointment online? Answer: You can schedule an appointment through our patient portal by selecting your preferred date and healthcare provider.&#39;,
  &#39;metadata&#39;: {&#39;category&#39;: &#39;appointments&#39;}},
 {&#39;text&#39;: &#39;Question: Can I reschedule or cancel my appointment online? Answer: Yes, you can easily reschedule or cancel your appointment via your patient portal.&#39;,
  &#39;metadata&#39;: {&#39;category&#39;: &#39;appointments&#39;}},
 {&#39;text&#39;: &#39;Question: What doctors are available for appointments? Answer: The following doctors are available five days of the week: Dr. Smith (Cardiology), Dr. Johnson (Dermatology), Dr. Lee (Pediatrics), Dr. Patel (Orthopedics), and Dr. Garcia (Neurology). For more details check the appointment section in your portal.&#39;,
  &#39;metadata&#39;: {&#39;category&#39;: &#39;appointments&#39;}}]</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="9" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="szyV20gJabbi" data-outputId="2ef9d24c-e99c-4d70-f37c-b77dee37e8ae">
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true"></a>external_data[<span class="op">-</span><span class="dv">1</span>:]</span></code></pre></div>
<div class="output execute_result" data-execution_count="9">
<pre><code>[{&#39;text&#39;: &#39;Question: Is my insurance information kept confidential? Answer: Yes, all insurance information is handled in strict compliance with HIPAA regulations to ensure your privacy.&#39;,
  &#39;metadata&#39;: {&#39;category&#39;: &#39;insurance&#39;}}]</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="10" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="pu87Lxosdkrx" data-outputId="416cd20d-6a7c-432c-b46f-650513db130b">
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true"></a><span class="co"># For vector database processing, we need to change external data into LangChain document.</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true"></a><span class="im">from</span> langchain.schema <span class="im">import</span> Document</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true"></a>prepared_documents <span class="op">=</span> []</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true"></a><span class="cf">for</span> document_data <span class="kw">in</span> tqdm(external_data ):</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true"></a>  document_data_text <span class="op">=</span> document_data[<span class="st">&#39;text&#39;</span>]</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true"></a>  document_data_metadata <span class="op">=</span> document_data[<span class="st">&#39;metadata&#39;</span>]</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true"></a>  prepared_documents.append(Document( metadata <span class="op">=</span> document_data_metadata, page_content <span class="op">=</span> document_data_text))</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true"></a>prepared_documents[:<span class="dv">2</span>]</span></code></pre></div>
<div class="output stream stderr">
<pre><code>100%|██████████| 40/40 [00:00&lt;00:00, 76748.47it/s]
</code></pre>
</div>
<div class="output execute_result" data-execution_count="10">
<pre><code>[Document(metadata={&#39;category&#39;: &#39;billing&#39;}, page_content=&quot;Question: How can I view my healthcare billing statement online? Answer: You can view your billing statement by logging into your patient portal and selecting &#39;Billing Statements&#39;.&quot;),
 Document(metadata={&#39;category&#39;: &#39;billing&#39;}, page_content=&#39;Question: What payment methods are accepted for medical bills? Answer: We accept credit cards, bank transfers, and insurance payments for settling your medical bills.&#39;)]</code></pre>
</div>
</div>
<section id="load-healthcare-knowledge-base-kb-into-vector-database" class="cell markdown" id="_7ugsuGred9x">
<h1>Load healthcare Knowledge Base (KB) into vector database</h1>
</section>
<div class="cell code" id="SzXCAh1ZepAe">
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<section id="ai-is-just-looking-for-a-well-organized-dataset-where-i-can-load-my-vector-database" class="cell markdown" id="elKcd_K3Zx82">
<h1>AI is just looking for a well-organized dataset where I can load my vector database.</h1>
</section>
<div class="cell code" data-execution_count="11" id="PLSIDqPQoPri">
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true"></a><span class="co"># To create a vector database, we need to make embeddings for text documents.</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true"></a><span class="im">from</span> langchain_openai <span class="im">import</span> OpenAIEmbeddings</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true"></a>openai_embedding_model <span class="op">=</span> OpenAIEmbeddings(model <span class="op">=</span> <span class="st">&#39;text-embedding-3-small&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" id="hkweTcH3rikB">
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="12" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="E-tXc4gaZv1Y" data-outputId="6e5aa77a-dafe-4b22-d935-6e56f9ceef79">
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true"></a><span class="im">from</span> langchain_chroma <span class="im">import</span> Chroma</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true"></a><span class="co"># Create Chroma vector database with OpenAI embeddings</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true"></a>company_vector_db <span class="op">=</span> Chroma.from_documents(documents <span class="op">=</span> prepared_documents, embedding <span class="op">=</span> openai_embedding_model, collection_name <span class="op">=</span> <span class="st">&#39;knowledge_base&#39;</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true"></a>                                          persist_directory <span class="op">=</span> <span class="st">&#39;./knowledge_base&#39;</span>, collection_metadata <span class="op">=</span> {<span class="st">&#39;hnsw:space&#39;</span>: <span class="st">&#39;cosine&#39;</span>})</span></code></pre></div>
<div class="output stream stderr">
<pre><code>ERROR:chromadb.telemetry.product.posthog:Failed to send telemetry event ClientStartEvent: capture() takes 1 positional argument but 3 were given
ERROR:chromadb.telemetry.product.posthog:Failed to send telemetry event ClientCreateCollectionEvent: capture() takes 1 positional argument but 3 were given
</code></pre>
</div>
</div>
<section id="vector-store-query-engine" class="cell markdown" id="ImNN_xy1aynQ">
<h1>Vector store query engine</h1>
</section>
<div class="cell code" id="JQw2z_gKbNmU">
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="13" id="C_O1tcb7sUUp">
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true"></a>company_data_lookup <span class="op">=</span> company_vector_db.as_retriever(search_type <span class="op">=</span> <span class="st">&#39;similarity_score_threshold&#39;</span>, search_kwargs <span class="op">=</span> {<span class="st">&#39;k&#39;</span>: <span class="dv">4</span>, <span class="st">&#39;score_threshold&#39;</span>: <span class="fl">0.2</span>})</span></code></pre></div>
</div>
<div class="cell code" id="1pcNv3WI1JyT">
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="14" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="QX_LpCU2BHmR" data-outputId="fe276c96-a6c3-42e0-c374-b307fb4b21e7">
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true"></a><span class="co"># Find a list of available categories from chroma vector store.</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true"></a>metadata_results <span class="op">=</span> company_vector_db._collection.get(include<span class="op">=</span> [<span class="st">&#39;metadatas&#39;</span>])</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true"></a>list_categories  <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true"></a><span class="cf">for</span> data <span class="kw">in</span> metadata_results[<span class="st">&#39;metadatas&#39;</span>]:</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true"></a>    <span class="cf">if</span> <span class="st">&#39;category&#39;</span> <span class="kw">in</span> data:</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true"></a>        list_categories.add(data[<span class="st">&#39;category&#39;</span>])</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true"></a></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true"></a><span class="bu">print</span>(list_categories)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>ERROR:chromadb.telemetry.product.posthog:Failed to send telemetry event CollectionGetEvent: capture() takes 1 positional argument but 3 were given
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>{&#39;billing&#39;, &#39;appointments&#39;, &#39;medical_records&#39;, &#39;insurance&#39;}
</code></pre>
</div>
</div>
<div class="cell code" id="bgau9ufqLJK2">
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true"></a><span class="co"># Is each category working well?</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="15" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="NS_62bVsBHzv" data-outputId="833427a2-ff61-4c40-c892-ad8f5aeb086f">
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true"></a>question <span class="op">=</span> <span class="st">&#39;How can I update my car insurance policy? &#39;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true"></a>general_data_filter <span class="op">=</span> {<span class="st">&#39;category&#39;</span>: <span class="st">&#39;insurance&#39;</span>}</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true"></a>company_data_lookup.search_kwargs[<span class="st">&#39;filter&#39;</span>] <span class="op">=</span> general_data_filter</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true"></a>company_data_lookup.invoke(question)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>ERROR:chromadb.telemetry.product.posthog:Failed to send telemetry event CollectionQueryEvent: capture() takes 1 positional argument but 3 were given
</code></pre>
</div>
<div class="output execute_result" data-execution_count="15">
<pre><code>[Document(id=&#39;a7a6bb35-51e1-4935-ad4f-bfbfdd26afdc&#39;, metadata={&#39;category&#39;: &#39;insurance&#39;}, page_content=&#39;Question: Can I add a new insurance policy to my account? Answer: Yes, you can update your insurance information through the insurance settings in your patient portal.&#39;),
 Document(id=&#39;fcabed08-2d81-4628-b673-df4b3ee2c77e&#39;, metadata={&#39;category&#39;: &#39;insurance&#39;}, page_content=&#39;Question: How are changes in insurance policies communicated to patients? Answer: Any changes are updated in your patient portal and communicated through email notifications.&#39;),
 Document(id=&#39;bf8ee54e-e3e2-4c1f-9f03-37fddd9a0691&#39;, metadata={&#39;category&#39;: &#39;insurance&#39;}, page_content=&#39;Question: How do I verify my insurance coverage online? Answer: Verify your insurance details by logging into our patient portal and accessing the insurance section.&#39;),
 Document(id=&#39;133056b9-bac1-4f77-8370-0fb20c7a618c&#39;, metadata={&#39;category&#39;: &#39;insurance&#39;}, page_content=&#39;Question: What should I do if my insurance claim is denied? Answer: If a claim is denied, please contact our insurance support department to review the issue and resubmit your claim if needed.&#39;)]</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="16" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="_wkc9MmQKRvA" data-outputId="b7ab1b02-c4e7-40e3-d00b-94e20bd99e5a">
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true"></a>question <span class="op">=</span> <span class="st">&#39;Can I get access for my medical records?&#39;</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true"></a>general_data_filter <span class="op">=</span> {<span class="st">&#39;category&#39;</span>: <span class="st">&#39;medical_records&#39;</span>}</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true"></a>company_data_lookup.search_kwargs[<span class="st">&#39;filter&#39;</span>] <span class="op">=</span> general_data_filter</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true"></a>company_data_lookup.invoke(question)</span></code></pre></div>
<div class="output execute_result" data-execution_count="16">
<pre><code>[Document(id=&#39;4be7da9c-7e28-4074-a35f-6509634e3089&#39;, metadata={&#39;category&#39;: &#39;medical_records&#39;}, page_content=&#39;Question: Can I request a copy of my medical history? Answer: Yes, you can request a copy of your medical history through the patient portal or by contacting our records department.&#39;),
 Document(id=&#39;5b766faf-fce5-4a8d-a9dd-b79fb7a5cb46&#39;, metadata={&#39;category&#39;: &#39;medical_records&#39;}, page_content=&#39;Question: How can I access my medical records online? Answer: You can access your medical records through our secure patient portal using your login credentials.&#39;),
 Document(id=&#39;cb782ccb-089c-4bc7-abdf-975445b35ae0&#39;, metadata={&#39;category&#39;: &#39;medical_records&#39;}, page_content=&#39;Question: Can I authorize someone else to access my medical records? Answer: Yes, you can grant access to a trusted family member or representative via our authorization process.&#39;),
 Document(id=&#39;6e602c30-cc62-4e15-ba69-d1a2add543d7&#39;, metadata={&#39;category&#39;: &#39;medical_records&#39;}, page_content=&#39;Question: Is there a fee for obtaining my medical records? Answer: Fees may apply for extensive record requests; please refer to our fee schedule on the records department page.&#39;)]</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="17" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="BarCiAMNjr6Z" data-outputId="04881293-f6aa-43e1-ac09-e799b938d589">
<div class="sourceCode" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true"></a>question <span class="op">=</span> <span class="st">&#39;Can I pay the due amount by credit card?&#39;</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true"></a>general_data_filter <span class="op">=</span> {<span class="st">&#39;category&#39;</span>:  <span class="st">&#39;billing&#39;</span>}</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true"></a>company_data_lookup.search_kwargs[<span class="st">&#39;filter&#39;</span>] <span class="op">=</span> general_data_filter</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true"></a>company_data_lookup.invoke(question)</span></code></pre></div>
<div class="output execute_result" data-execution_count="17">
<pre><code>[Document(id=&#39;23b2ae07-e2a5-4f09-871f-5896a554fb8c&#39;, metadata={&#39;category&#39;: &#39;billing&#39;}, page_content=&#39;Question: What payment methods are accepted for medical bills? Answer: We accept credit cards, bank transfers, and insurance payments for settling your medical bills.&#39;),
 Document(id=&#39;ba2894af-a4e3-4044-923e-a3c01e1699ab&#39;, metadata={&#39;category&#39;: &#39;billing&#39;}, page_content=&#39;Question: Is there a discount for upfront payment of my medical bill? Answer: Some facilities offer discounts for upfront payments; please contact our billing department for details.&#39;),
 Document(id=&#39;78113614-4cff-4d10-9ac4-dda5f758f174&#39;, metadata={&#39;category&#39;: &#39;billing&#39;}, page_content=&#39;Question: What is the process for disputing a charge on my medical bill? Answer: You can dispute any charges by contacting our billing department and submitting a formal inquiry.&#39;),
 Document(id=&#39;cc8d54e9-e73a-44e6-bb7f-d7d4c1fe58f7&#39;, metadata={&#39;category&#39;: &#39;billing&#39;}, page_content=&#39;Question: Can I get a detailed invoice for my medical services? Answer: Yes, a detailed invoice is available in your patient portal under the billing section.&#39;)]</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="18" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="H3KPtlG5wC9s" data-outputId="0d6353bc-385b-4280-b03a-1f1345d1542f">
<div class="sourceCode" id="cb57"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true"></a>question <span class="op">=</span> <span class="st">&#39;Can you help me schedule an appointment with my regular doctor?&#39;</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true"></a>general_data_filter <span class="op">=</span> {<span class="st">&#39;category&#39;</span>: <span class="st">&#39;appointments&#39;</span>}</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true"></a>company_data_lookup.search_kwargs[<span class="st">&#39;filter&#39;</span>] <span class="op">=</span> general_data_filter</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true"></a>company_data_lookup.invoke(question)</span></code></pre></div>
<div class="output execute_result" data-execution_count="18">
<pre><code>[Document(id=&#39;5f0c5e5b-30d3-4fb8-be77-a4a7ec3c4dd8&#39;, metadata={&#39;category&#39;: &#39;appointments&#39;}, page_content=&#39;Question: How do I schedule a medical appointment online? Answer: You can schedule an appointment through our patient portal by selecting your preferred date and healthcare provider.&#39;),
 Document(id=&#39;ff1cc517-b254-4d45-9371-4eea634cb58c&#39;, metadata={&#39;category&#39;: &#39;appointments&#39;}, page_content=&#39;Question: What doctors are available for appointments? Answer: The following doctors are available five days of the week: Dr. Smith (Cardiology), Dr. Johnson (Dermatology), Dr. Lee (Pediatrics), Dr. Patel (Orthopedics), and Dr. Garcia (Neurology). For more details check the appointment section in your portal.&#39;),
 Document(id=&#39;bd883d93-1dab-4b81-881a-61f68ebef566&#39;, metadata={&#39;category&#39;: &#39;appointments&#39;}, page_content=&#39;Question: How do I find out which doctors are available for my appointment? Answer: Doctor availability is listed on our appointment portal; you can filter by specialty and location.&#39;),
 Document(id=&#39;6d3f444f-2cb4-4700-8523-a9849bc12d57&#39;, metadata={&#39;category&#39;: &#39;appointments&#39;}, page_content=&#39;Question: Is same-day appointment scheduling available? Answer: In many cases, same-day appointments are available. For urgent needs, please contact our scheduling department.&#39;)]</code></pre>
</div>
</div>
<div class="cell code" id="g7zNzrUdJO0_">
<div class="sourceCode" id="cb59"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<section id="create-the-agentic-rag-routing-system" class="cell markdown" id="qSxb50kTlLUU">
<h1>Create the agentic RAG routing system</h1>
</section>
<div class="cell code" id="fJSCrSsO1RBt">
<div class="sourceCode" id="cb60"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<section id="customer-support-interaction-structure" class="cell markdown" id="yya8oC_tNGhB">
<h1>Customer support interaction structure</h1>
</section>
<div class="cell code" data-execution_count="19" id="ASHa8JNDNSxk">
<div class="sourceCode" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true"></a><span class="im">from</span> typing <span class="im">import</span> TypedDict</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true"></a><span class="kw">class</span> Support_Interaction_Record(TypedDict):</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true"></a>  user_question: <span class="bu">str</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true"></a>  question_type: <span class="bu">str</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true"></a>  question_sentiment: <span class="bu">str</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true"></a>  human_support_contact: <span class="bu">dict</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true"></a>  emergency_contact_information: <span class="bu">dict</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true"></a>  agent_reply: <span class="bu">str</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true"></a>  user_id: <span class="bu">str</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="20" id="A_3p5QaoNS1A">
<div class="sourceCode" id="cb62"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true"></a><span class="im">from</span> pydantic <span class="im">import</span> BaseModel</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true"></a><span class="im">from</span> typing <span class="im">import</span> Literal</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true"></a><span class="kw">class</span> Question_Type(BaseModel):</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true"></a>  inquiry_type: Literal[<span class="st">&#39;insurance&#39;</span>, <span class="st">&#39;medical_records&#39;</span>, <span class="st">&#39;billing&#39;</span>, <span class="st">&#39;appointments&#39;</span>]</span></code></pre></div>
</div>
<div class="cell code" id="7CJGUhlHU8nk">
<div class="sourceCode" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="21" id="PTl4ixzKT5yx">
<div class="sourceCode" id="cb64"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true"></a><span class="kw">class</span> Question_Feeling(BaseModel):</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true"></a>  feeling: Literal[<span class="st">&#39;Good&#39;</span>, <span class="st">&#39;Average&#39;</span>, <span class="st">&#39;Bad&#39;</span>, <span class="st">&#39;Emergency&#39;</span>]</span></code></pre></div>
</div>
<section id="node-functions-for-making-a-customer-support-pipeline" class="cell markdown" id="iKyUR2wabwqj">
<h1>Node functions for making a customer support pipeline</h1>
</section>
<div class="cell code" data-execution_count="22" id="cb1Ts0BDbvTV">
<div class="sourceCode" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true"></a><span class="im">from</span> langchain_openai <span class="im">import</span> ChatOpenAI</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true"></a>chatopenai_llm <span class="op">=</span> ChatOpenAI(model <span class="op">=</span> <span class="st">&#39;gpt-4o&#39;</span>, temperature<span class="op">=</span><span class="dv">0</span>)</span></code></pre></div>
</div>
<div class="cell code" id="bkQ6EM6VIbHO">
<div class="sourceCode" id="cb66"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="23" id="fIX3PRa5-kUr">
<div class="sourceCode" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true"></a><span class="kw">def</span> classify_question(support_state: Support_Interaction_Record) <span class="op">-&gt;</span> Support_Interaction_Record:</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true"></a>  <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true"></a><span class="co">  Analyze the customer question. Find a category from insurance, medical_records, billing, or appointments which fully fits</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true"></a><span class="co">  to the customer’s question.</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true"></a><span class="co">  &#39;&#39;&#39;</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true"></a>  classify_prompt <span class="op">=</span> <span class="ss">f&#39;&#39;&#39;</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true"></a><span class="ss">  You are an experienced healthcare support agent. You can easily classify the customer questions. Please take your time to review the customer</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true"></a><span class="ss">  questions. Finally, you need to categorize questions into one of the following. &#39;insurance&#39;, &#39;medical_records&#39;, &#39;billing&#39;, or &#39;appointments&#39;.</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true"></a></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true"></a><span class="ss">  Question:</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true"></a><span class="ss">  </span><span class="sc">{</span>support_state[<span class="st">&#39;user_question&#39;</span>]<span class="sc">}</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true"></a></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true"></a><span class="ss">  Make sure you must return one classify name only.</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true"></a><span class="ss">  &#39;&#39;&#39;</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true"></a>  inquiry_category <span class="op">=</span> chatopenai_llm.with_structured_output(Question_Type).invoke(classify_prompt)</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true"></a>  results <span class="op">=</span> chatopenai_llm.invoke(classify_prompt).content.strip().lower()</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true"></a>  support_state[<span class="st">&#39;question_type&#39;</span>] <span class="op">=</span> results</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true"></a></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true"></a>  <span class="cf">return</span> support_state</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="24" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="21Ya4QE10DFz" data-outputId="8ae752c1-90da-49b2-a699-a96bff29e3ba">
<div class="sourceCode" id="cb68"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true"></a><span class="co"># Check: is this function working?</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true"></a>classify_question({<span class="st">&quot;user_question&quot;</span>: <span class="st">&#39;Tell your user which payment methods you can consider.&#39;</span>})</span></code></pre></div>
<div class="output execute_result" data-execution_count="24">
<pre><code>{&#39;user_question&#39;: &#39;Tell your user which payment methods you can consider.&#39;,
 &#39;question_type&#39;: &#39;billing&#39;}</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="25" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="KlYm4nV70DJV" data-outputId="bf530229-3378-46d0-f948-48888f3f0d18">
<div class="sourceCode" id="cb70"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true"></a></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true"></a>check_state <span class="op">=</span> {<span class="st">&#39;user_question&#39;</span>: <span class="st">&#39;Tell your user which payment methods you can consider.&#39;</span>, <span class="st">&#39;question_type&#39;</span>: <span class="st">&#39;&#39;</span>, <span class="st">&#39;question_sentiment&#39;</span>: <span class="st">&#39;&#39;</span>,</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true"></a>               <span class="st">&#39;human_support_contact&#39;</span>: {}, <span class="st">&#39;emergency_contact_information&#39;</span>: {}, <span class="st">&#39;agent_reply&#39;</span>: <span class="st">&#39;&#39;</span>, <span class="st">&#39;user_id&#39;</span>: <span class="st">&#39;check_state_0981&#39;</span>}</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true"></a><span class="bu">print</span>(classify_question(check_state))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>{&#39;user_question&#39;: &#39;Tell your user which payment methods you can consider.&#39;, &#39;question_type&#39;: &#39;billing&#39;, &#39;question_sentiment&#39;: &#39;&#39;, &#39;human_support_contact&#39;: {}, &#39;emergency_contact_information&#39;: {}, &#39;agent_reply&#39;: &#39;&#39;, &#39;user_id&#39;: &#39;check_state_0981&#39;}
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="26" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="9VplVkRPDxKd" data-outputId="41b8a569-d182-438e-f8f8-e9c53a0b029f">
<div class="sourceCode" id="cb72"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true"></a>classify_question({<span class="st">&quot;user_question&quot;</span>: <span class="st">&#39;how  do I change my policy?&#39;</span>})</span></code></pre></div>
<div class="output execute_result" data-execution_count="26">
<pre><code>{&#39;user_question&#39;: &#39;how  do I change my policy?&#39;, &#39;question_type&#39;: &#39;insurance&#39;}</code></pre>
</div>
</div>
<div class="cell code" id="ESfbxSB5l_5P">
<div class="sourceCode" id="cb74"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="27" id="ALBHfLGzI0gF">
<div class="sourceCode" id="cb75"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true"></a><span class="kw">def</span> sentiment_analysis_node(support_state: Support_Interaction_Record) <span class="op">-&gt;</span> Support_Interaction_Record:</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true"></a>    <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true"></a><span class="co">    Research on sentimental options such as Good, Average, Bad, Emergency on customer’s questions.</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true"></a><span class="co">    &#39;&#39;&#39;</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true"></a>    sentiment_analysis_node_prompt <span class="op">=</span> <span class="ss">f&#39;&#39;&#39;</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true"></a><span class="ss">    You are an experienced healthcare customer support agent. You can easily categorize the overall customer sentiment. Please take your time to</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true"></a><span class="ss">    review the customer questions as given below. Finally, you need to categorize the sentiment into one of the following customer sentiment options.</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true"></a><span class="ss">    &#39;Good&#39;, &#39;Average&#39;, &#39;Bad&#39;, &#39;Emergency&#39;</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true"></a></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true"></a><span class="ss">    You need to consider the following rules:</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true"></a><span class="ss">    - Good means positive results.</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true"></a><span class="ss">    - Average means neutral.</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true"></a><span class="ss">    - Bad means negative results.</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true"></a><span class="ss">    - Emergency means serious health problems.</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true"></a></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true"></a></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true"></a><span class="ss">    Message:</span></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true"></a><span class="ss">    </span><span class="sc">{</span>support_state[<span class="st">&#39;user_question&#39;</span>]<span class="sc">}</span></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true"></a></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true"></a><span class="ss">    Make sure you return one of the sentiment labels.</span></span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true"></a><span class="ss">    &#39;&#39;&#39;</span></span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true"></a>    sentiment <span class="op">=</span> chatopenai_llm.invoke(sentiment_analysis_node_prompt).content.strip()</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true"></a>    support_state[<span class="st">&#39;question_sentiment&#39;</span>] <span class="op">=</span> sentiment</span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true"></a>    <span class="cf">return</span> support_state</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="28" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="OuPAZUViV3_5" data-outputId="97923970-55cf-4a29-9e4d-81ffd746c183">
<div class="sourceCode" id="cb76"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true"></a><span class="co"># Test the above function</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true"></a>sentiment_analysis_node({<span class="st">&quot;user_question&quot;</span>: <span class="st">&#39;Thank you. I appreciate your support.&#39;</span>})</span></code></pre></div>
<div class="output execute_result" data-execution_count="28">
<pre><code>{&#39;user_question&#39;: &#39;Thank you. I appreciate your support.&#39;,
 &#39;question_sentiment&#39;: &#39;Good&#39;}</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="29" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="qMIs6eVUV4DR" data-outputId="8e055c0b-d41d-4dc9-fb08-ddac6a702a79">
<div class="sourceCode" id="cb78"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true"></a>sentiment_analysis_node({<span class="st">&quot;user_question&quot;</span>: <span class="st">&#39;She has a serious health issue. She needs help.&#39;</span>})</span></code></pre></div>
<div class="output execute_result" data-execution_count="29">
<pre><code>{&#39;user_question&#39;: &#39;She has a serious health issue. She needs help.&#39;,
 &#39;question_sentiment&#39;: &#39;Emergency&#39;}</code></pre>
</div>
</div>
<div class="cell code" id="anQcqhIQ8ny-">
<div class="sourceCode" id="cb80"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="31" id="xEI78-Md5KCR">
<div class="sourceCode" id="cb81"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true"></a><span class="im">from</span> langchain_core.prompts <span class="im">import</span> ChatPromptTemplate</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true"></a><span class="co"># Note:  To get better output, we need to improve the  department_assistant_reply node.</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true"></a><span class="kw">def</span> department_assistant_reply(support_state: Support_Interaction_Record) <span class="op">-&gt;</span> Support_Interaction_Record:</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true"></a>    <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true"></a><span class="co">    Generate a department-specific response using RAG (Chroma + LLM).</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true"></a><span class="co">    &#39;&#39;&#39;</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true"></a>    query <span class="op">=</span> support_state[<span class="st">&#39;user_question&#39;</span>]</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true"></a></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true"></a>    question_type <span class="op">=</span> support_state[<span class="st">&#39;question_type&#39;</span>]  <span class="co">#  &#39;insurance&#39;, &#39;medical_records&#39;, &#39;billing&#39;, &#39;appointments&#39;</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true"></a></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true"></a></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true"></a>    <span class="co"># Example:  question_type (&#39;insurance&#39;),  Metadata Filter ( &#39;insurance&#39;),  Public name ( &#39;Insurance&#39; )</span></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true"></a>    question_type_map <span class="op">=</span> {<span class="st">&#39;insurance&#39;</span>: (<span class="st">&#39;insurance&#39;</span>, <span class="st">&#39;Insurance&#39;</span>), <span class="st">&#39;medical_records&#39;</span>: (<span class="st">&#39;medical_records&#39;</span>, <span class="st">&#39;Medical Records&#39;</span>),</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true"></a>                         <span class="st">&#39;billing&#39;</span>: (<span class="st">&#39;billing&#39;</span>, <span class="st">&#39;Billing&#39;</span>), <span class="st">&#39;appointments&#39;</span>: (<span class="st">&#39;appointments&#39;</span>, <span class="st">&#39;Appointments&#39;</span>), }</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true"></a></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true"></a>    <span class="co"># Example: filter_key, label wre  (&#39;insurance&#39;, &#39;Insurance&#39;)</span></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true"></a>    filter_key, label <span class="op">=</span> question_type_map[question_type]</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true"></a></span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true"></a>    company_data_lookup.search_kwargs[<span class="st">&#39;filter&#39;</span>] <span class="op">=</span> {<span class="st">&#39;category&#39;</span>: filter_key}       <span class="co"># Narrow search results</span></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true"></a></span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true"></a>    <span class="co">#  Want to see matching documents.</span></span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true"></a>    search_documents <span class="op">=</span> company_data_lookup.invoke(query)</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true"></a>    source_text <span class="op">=</span> <span class="st">&#39;</span><span class="ch">\n\n</span><span class="st">&#39;</span>.join(document.page_content <span class="cf">for</span> document <span class="kw">in</span> search_documents)</span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true"></a></span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true"></a></span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true"></a>    chat_template <span class="op">=</span> ChatPromptTemplate.from_template(</span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true"></a>    <span class="st">&#39;&#39;&#39;</span></span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true"></a><span class="st">    You are an experienced healthcare customer support agent. Please provide a clear and accurate response related to </span><span class="sc">{department}</span><span class="st">.</span></span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true"></a><span class="st">    Use ONLY the knowledge base information provided below.</span></span>
<span id="cb81-32"><a href="#cb81-32" aria-hidden="true"></a></span>
<span id="cb81-33"><a href="#cb81-33" aria-hidden="true"></a><span class="st">    If the information is insufficient, say:</span></span>
<span id="cb81-34"><a href="#cb81-34" aria-hidden="true"></a><span class="st">    &quot;Sorry. I could not provide right information. Please contact customer service.&quot;</span></span>
<span id="cb81-35"><a href="#cb81-35" aria-hidden="true"></a></span>
<span id="cb81-36"><a href="#cb81-36" aria-hidden="true"></a><span class="st">    Customer Question:</span></span>
<span id="cb81-37"><a href="#cb81-37" aria-hidden="true"></a><span class="st">    </span><span class="sc">{question}</span></span>
<span id="cb81-38"><a href="#cb81-38" aria-hidden="true"></a></span>
<span id="cb81-39"><a href="#cb81-39" aria-hidden="true"></a><span class="st">    Knowledge Base Information:</span></span>
<span id="cb81-40"><a href="#cb81-40" aria-hidden="true"></a><span class="st">    </span><span class="sc">{context}</span></span>
<span id="cb81-41"><a href="#cb81-41" aria-hidden="true"></a><span class="st">    &#39;&#39;&#39;</span>)</span>
<span id="cb81-42"><a href="#cb81-42" aria-hidden="true"></a></span>
<span id="cb81-43"><a href="#cb81-43" aria-hidden="true"></a></span>
<span id="cb81-44"><a href="#cb81-44" aria-hidden="true"></a>    llm_pipeline <span class="op">=</span>  chat_template <span class="op">|</span> chatopenai_llm</span>
<span id="cb81-45"><a href="#cb81-45" aria-hidden="true"></a></span>
<span id="cb81-46"><a href="#cb81-46" aria-hidden="true"></a>    llm_output <span class="op">=</span> llm_pipeline.invoke({<span class="st">&#39;department&#39;</span>: label, <span class="st">&#39;question&#39;</span>: query, <span class="st">&#39;context&#39;</span>: source_text}).content</span>
<span id="cb81-47"><a href="#cb81-47" aria-hidden="true"></a></span>
<span id="cb81-48"><a href="#cb81-48" aria-hidden="true"></a>    support_state[<span class="st">&#39;agent_reply&#39;</span>] <span class="op">=</span> llm_output</span>
<span id="cb81-49"><a href="#cb81-49" aria-hidden="true"></a>    <span class="cf">return</span> support_state</span></code></pre></div>
</div>
<div class="cell code" id="aifaBRBd5KFv">
<div class="sourceCode" id="cb82"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="32" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="DhXntW0o4nr2" data-outputId="a88bb9f4-f09c-4d5d-94ae-dec41fda8489">
<div class="sourceCode" id="cb83"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true"></a>function_test_quety <span class="op">=</span> <span class="st">&#39;How can I request a copy of my medical history?&#39;</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true"></a>sample_input <span class="op">=</span> {<span class="st">&#39;user_question&#39;</span>: function_test_quety ,<span class="st">&#39;question_type&#39;</span>: <span class="st">&#39;medical_records&#39;</span>}</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true"></a></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true"></a>assistant_reply <span class="op">=</span> department_assistant_reply(sample_input)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true"></a></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true"></a><span class="bu">print</span>(assistant_reply[<span class="st">&#39;agent_reply&#39;</span>])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>You can request a copy of your medical history through the patient portal or by contacting our records department.
</code></pre>
</div>
</div>
<section id="records-customer-contact-details-when-negative-sentiment-is-noticed" class="cell markdown" id="jMol3FrdA01K">
<h1>Records customer contact details when negative sentiment is noticed.</h1>
</section>
<div class="cell code" data-execution_count="33" id="CdAzCr6ZBM2e">
<div class="sourceCode" id="cb85"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true"></a><span class="im">import</span> ipywidgets <span class="im">as</span> widgets</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true"></a><span class="im">from</span> IPython.display <span class="im">import</span> display</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="34" id="-iLcm2ulPTXs">
<div class="sourceCode" id="cb86"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true"></a><span class="kw">def</span> gather_user_contact_information(support_state: Support_Interaction_Record) <span class="op">-&gt;</span> Support_Interaction_Record:</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true"></a>  <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true"></a><span class="co">  Collect customer information and connect with a support agent</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true"></a><span class="co">  &#39;&#39;&#39;</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true"></a>  form_title <span class="op">=</span> widgets.HTML(<span class="st">&#39;&lt;h3&gt;Help Desk Escalation Form&lt;/h3&gt;&#39;</span>)</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true"></a></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true"></a>  <span class="co"># Input fields</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true"></a></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true"></a>  user_id_field <span class="op">=</span> widgets.Text(description <span class="op">=</span> <span class="st">&#39;Issue ID:&#39;</span>)</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true"></a>  user_name_field <span class="op">=</span> widgets.Text(description <span class="op">=</span> <span class="st">&#39;Name:&#39;</span>)</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true"></a>  user_email_field <span class="op">=</span> widgets.Text(description <span class="op">=</span> <span class="st">&#39;Email:&#39;</span>)</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true"></a>  user_phone_field <span class="op">=</span> widgets.Text(description <span class="op">=</span> <span class="st">&#39;Phone:&#39;</span>)</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true"></a>  user_contact_time_field <span class="op">=</span> widgets.Text(description <span class="op">=</span> <span class="st">&#39;Best Time to Call:&#39;</span>)</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true"></a></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true"></a>  submit_request_button <span class="op">=</span> widgets.Button(description <span class="op">=</span> <span class="st">&#39;Submit Request&#39;</span>)</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true"></a>  result_display <span class="op">=</span> widgets.Output()</span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true"></a></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true"></a>  <span class="kw">def</span> process_user_input(button):</span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true"></a>    support_state[<span class="st">&#39;customer_support_details&#39;</span>] <span class="op">=</span> {<span class="st">&#39;issue_id&#39;</span>: user_id_field.value, <span class="st">&#39;name&#39;</span>: user_name_field.value, <span class="st">&#39;email&#39;</span>: user_email_field.value,</span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true"></a>                                                 <span class="st">&#39;phone&#39;</span>: user_phone_field.value, <span class="st">&#39;best_time_to_call&#39;</span>: user_contact_time_field.value}</span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true"></a>    <span class="cf">with</span> result_display:</span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true"></a>      <span class="bu">print</span>(<span class="st">&#39;Request submitted&#39;</span>)</span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true"></a>    submit_request_button.disabled <span class="op">=</span> <span class="va">True</span></span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true"></a></span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true"></a>  submit_request_button.on_click(process_user_input)</span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true"></a></span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true"></a>    <span class="co">#  Display Structure</span></span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true"></a></span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true"></a>  display(widgets.VBox([form_title, user_id_field, user_name_field, user_email_field, user_phone_field, user_contact_time_field, submit_request_button, result_display]))</span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true"></a></span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true"></a>  <span class="cf">return</span> support_state</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="35" data-colab="{&quot;height&quot;:278,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;referenced_widgets&quot;:[&quot;b7716c6fd4974a23bcacf27f5865e9a6&quot;,&quot;cb2ef4bae2b14edba4fbc13e4269ecaf&quot;,&quot;fa890ebadf494034a4b0e9fef365d044&quot;,&quot;eadd733cc3bc4a418d89847f46380bae&quot;,&quot;44d16d6604f44bfc86b0b66bfdc62fe3&quot;,&quot;3f14f632de4e446bac06d76ea8a3a706&quot;,&quot;6eb37b43bc1649b3aa76043ba1dcb733&quot;,&quot;fcd4017976864c1b8248bfbc360481f5&quot;,&quot;8a58e417039545139f173e74ec9e1ea1&quot;,&quot;8a31a17cdcb042439a70596f85caa0ac&quot;,&quot;1221cd2387cb4b538182fd28b708a383&quot;,&quot;7c9ec5fc63db4eb2b852b132946e8af8&quot;,&quot;d84170ea3dd84dfeb4dd405aabed5a9a&quot;,&quot;6a19fbd036ff477ebf99401dc44e5718&quot;,&quot;9955c0fc8d664a6d8ddb0826f029f693&quot;,&quot;89762820666f4dc295bdd416a1665e63&quot;,&quot;477270bc4cac4f4b85439d1fe23a87d2&quot;,&quot;12d4c79fa07844608962d3e60aca8fa8&quot;,&quot;0e3b93f3d5664824b4bfaca708ecb8f3&quot;,&quot;e564621b90544005a9debdbdf4aa4368&quot;,&quot;85db27365cd649dd85bffb38e91e8edf&quot;,&quot;1be87b49b99b44339b2dc33fe70b09bc&quot;,&quot;3c66e779ea9f4136bd498904beb33d06&quot;,&quot;6d80d9a26cd648e09466b3cc1dd0cf97&quot;,&quot;3ccdac6dc8d049c1b0586e440b725ad6&quot;]}" id="Kw7LL4wYoDpp" data-outputId="7dcc9e51-f9c6-4438-fef7-38a5cd82d610">
<div class="sourceCode" id="cb87"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true"></a>request_state <span class="op">=</span> {}</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true"></a>gather_user_contact_information(request_state)</span></code></pre></div>
<div class="output display_data">
<div class="sourceCode" id="cb88"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;b7716c6fd4974a23bcacf27f5865e9a6&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output execute_result" data-execution_count="35">
<pre><code>{}</code></pre>
</div>
</div>
<div class="cell code" id="xAnfeQ-eoDtp">
<div class="sourceCode" id="cb90"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<section id="send-the-issue-to-a-human-support-agent-and-notify-the-user" class="cell markdown" id="RmgCP6yv0uOw">
<h1>Send the issue to a human support agent and notify the user.</h1>
</section>
<div class="cell code" data-execution_count="35" id="9d2hXaGb0tCP">
<div class="sourceCode" id="cb91"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="37" id="13yDpmgBD7UL">
<div class="sourceCode" id="cb92"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true"></a><span class="kw">def</span> notify_human_support(support_state: Support_Interaction_Record) <span class="op">-&gt;</span> Support_Interaction_Record:</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true"></a>  <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true"></a><span class="co">  Route the request to human support and inform the user.</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true"></a><span class="co">  &#39;&#39;&#39;</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true"></a>  <span class="cf">if</span> <span class="st">&#39;customer_support_details&#39;</span> <span class="kw">not</span> <span class="kw">in</span> support_state:</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true"></a>    support_state[<span class="st">&#39;agent_reply&#39;</span>] <span class="op">=</span> (<span class="st">&#39;Apologies, your contact information was not received.</span><span class="ch">\n</span><span class="st">&#39;</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true"></a>    <span class="st">&#39;Please try again or contact customer support directly.&#39;</span>)</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true"></a>    <span class="cf">return</span> support_state</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true"></a>  customer_details <span class="op">=</span> support_state[<span class="st">&#39;customer_support_details&#39;</span>]</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true"></a></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true"></a>  agent_reply_text <span class="op">=</span> (<span class="ss">f&#39;Thank you very much </span><span class="sc">{</span>customer_details<span class="sc">.</span>get(<span class="st">&#39;name&#39;</span>, <span class="st">&#39;Customer&#39;</span>)<span class="sc">}</span><span class="ss">.</span><span class="ch">\n\n</span><span class="ss">&#39;</span></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true"></a>  <span class="ss">f&#39;Issue ID: </span><span class="sc">{</span>customer_details<span class="sc">.</span>get(<span class="st">&#39;issue_id&#39;</span>, <span class="st">&#39;N/A&#39;</span>)<span class="sc">}</span><span class="ch">\n</span><span class="ss">&#39;</span></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true"></a>  <span class="ss">f&#39;Email: </span><span class="sc">{</span>customer_details<span class="sc">.</span>get(<span class="st">&#39;email&#39;</span>, <span class="st">&#39;N/A&#39;</span>)<span class="sc">}</span><span class="ch">\n</span><span class="ss">&#39;</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true"></a>  <span class="ss">f&#39;Phone: </span><span class="sc">{</span>customer_details<span class="sc">.</span>get(<span class="st">&#39;phone&#39;</span>, <span class="st">&#39;N/A&#39;</span>)<span class="sc">}</span><span class="ch">\n</span><span class="ss">&#39;</span></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true"></a>  <span class="ss">f&#39;Requested Contact Time: </span><span class="sc">{</span>customer_details<span class="sc">.</span>get(<span class="st">&#39;best_time_to_call&#39;</span>, <span class="st">&#39;N/A&#39;</span>)<span class="sc">}</span><span class="ch">\n</span><span class="ss">&#39;</span></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true"></a>  <span class="st">&#39;Someone from our team will reach out to you shortly.</span><span class="ch">\n</span><span class="st">&#39;</span></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true"></a>  <span class="st">&#39;Thank you for your cooperation.&#39;</span></span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true"></a>  )</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true"></a>  support_state[<span class="st">&quot;agent_reply&quot;</span>] <span class="op">=</span> agent_reply_text</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true"></a>  support_state[<span class="st">&quot;human_support_contact&quot;</span>] <span class="op">=</span> customer_details</span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true"></a>  <span class="cf">return</span> support_state</span></code></pre></div>
</div>
<div class="cell code" id="smzoBqgTmrPi">
<div class="sourceCode" id="cb93"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="38" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="GIibFhtWKRvO" data-outputId="510e94cc-8431-4f78-dd20-c29ac57c09a0">
<div class="sourceCode" id="cb94"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true"></a><span class="co"># test function</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true"></a>support_state <span class="op">=</span> {<span class="st">&#39;question_sentiment&#39;</span>: <span class="st">&#39;Unhappy&#39;</span>, <span class="st">&#39;customer_support_details&#39;</span>: {<span class="st">&#39;issue_id&#39;</span>: <span class="st">&#39;GB-097&#39;</span>, <span class="st">&#39;name&#39;</span>: <span class="st">&#39;Tim&#39;</span>, <span class="st">&#39;email&#39;</span>: <span class="st">&#39;tim8@email.com&#39;</span>,</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true"></a>                                                                               <span class="st">&#39;phone&#39;</span>: <span class="st">&#39;447-000-8888&#39;</span>, <span class="st">&#39;best_time_to_call&#39;</span>: <span class="st">&#39; Today evening&#39;</span>}}</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true"></a></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true"></a>support_state <span class="op">=</span> notify_human_support(support_state)</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true"></a><span class="bu">print</span>(support_state[<span class="st">&#39;agent_reply&#39;</span>])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Thank you very much Tim.

Issue ID: GB-097
Email: tim8@email.com
Phone: 447-000-8888
Requested Contact Time:  Today evening
Someone from our team will reach out to you shortly.
Thank you for your cooperation.
</code></pre>
</div>
</div>
<div class="cell code" id="CjtdvKx4N0uT">
<div class="sourceCode" id="cb96"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<section id="collect-patient-details-for-emergency-medical-support" class="cell markdown" id="C0vBCjLehY0l">
<h1>Collect patient details for emergency medical support.</h1>
</section>
<div class="cell code" id="jdx9hgkJnd9s">
<div class="sourceCode" id="cb97"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="39" id="HsPD1wmr9IjH">
<div class="sourceCode" id="cb98"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true"></a></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true"></a><span class="kw">def</span> get_emergency_user_information(support_state: Support_Interaction_Record) <span class="op">-&gt;</span> Support_Interaction_Record:</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true"></a>  <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true"></a><span class="co">  Collects emergency details and connects users with emergency medical staff.</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true"></a><span class="co">  &#39;&#39;&#39;</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true"></a></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true"></a>  form_title <span class="op">=</span> widgets.HTML(<span class="st">&#39;&lt;h3&gt;Urgent Medical Contact Form&lt;/h3&gt;&#39;</span>)</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true"></a></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true"></a>  user_name_field <span class="op">=</span> widgets.Text(description <span class="op">=</span> <span class="st">&#39;Name:&#39;</span>, placeholder <span class="op">=</span> <span class="st">&#39;User full name&#39;</span>)</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true"></a>  user_phone_field <span class="op">=</span> widgets.Text(description <span class="op">=</span> <span class="st">&#39;Phone:&#39;</span>, placeholder <span class="op">=</span> <span class="st">&#39;Emergency contact number&#39;</span>)</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true"></a>  user_medical_issue_field <span class="op">=</span> widgets.Textarea(description <span class="op">=</span> <span class="st">&#39;Medical Issue:&#39;</span>, placeholder <span class="op">=</span> <span class="st">&#39;share details of your emergency situation&#39;</span>, layout <span class="op">=</span> widgets.Layout(width <span class="op">=</span> <span class="st">&#39;90%&#39;</span>))</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true"></a></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true"></a>  submit_request_button <span class="op">=</span> widgets.Button(description <span class="op">=</span> <span class="st">&#39;Send emergency form&#39;</span>, button_style <span class="op">=</span> <span class="st">&#39;danger&#39;</span>)</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true"></a>  result_display <span class="op">=</span> widgets.Output()</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true"></a></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true"></a>  <span class="kw">def</span> manage_user_input(button):</span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true"></a>    support_state[<span class="st">&#39;urgent_contact_information&#39;</span>] <span class="op">=</span> {<span class="st">&#39;name&#39;</span>: user_name_field.value, <span class="st">&#39;phone&#39;</span>: user_phone_field .value, <span class="st">&#39;symptoms&#39;</span>: user_medical_issue_field.value}</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true"></a>    <span class="cf">with</span> result_display:</span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true"></a>      result_display.clear_output()</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true"></a>      <span class="bu">print</span>(<span class="st">&#39;Emergency details registered. A doctor will contact you immediately.&#39;</span>)</span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true"></a>    submit_request_button.disabled <span class="op">=</span> <span class="va">True</span></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true"></a></span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true"></a>  submit_request_button.on_click(manage_user_input)</span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true"></a></span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true"></a>  <span class="co">#  Display Structure</span></span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true"></a></span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true"></a>  display(widgets.VBox([form_title, user_name_field, user_phone_field, user_medical_issue_field, submit_request_button, result_display]))</span>
<span id="cb98-28"><a href="#cb98-28" aria-hidden="true"></a></span>
<span id="cb98-29"><a href="#cb98-29" aria-hidden="true"></a>  <span class="cf">return</span> support_state</span>
<span id="cb98-30"><a href="#cb98-30" aria-hidden="true"></a></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="40" data-colab="{&quot;height&quot;:210,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;referenced_widgets&quot;:[&quot;753a5b5f280f4ee1bf9a6973a2f61e04&quot;,&quot;0c69c420cd384398bea6a13d2813a720&quot;,&quot;9e970779efbb45ad9fa68028c109e8c5&quot;,&quot;6b75dc36be044fe99933cda4c878b2d5&quot;,&quot;784bdf3fb3b8456690b2347f9099294d&quot;,&quot;a321cb0e1bc1466fbc68b2d543ccb006&quot;,&quot;bf89fabe95614aa9858094745e25f187&quot;,&quot;afd3ae264ff94121b824a271d35935b4&quot;,&quot;e9e7da4d82f6462d88ed741390345ced&quot;,&quot;c14ff9cdc2b445319455c07b4448910d&quot;,&quot;d5f17dc1935143118dfbcabf674f8424&quot;,&quot;162b982d57014422a7d02e6eecab2535&quot;,&quot;fabdfde888bf488e88db9d35ae0692c0&quot;,&quot;8a1ede704f4945d4b3ce20025bc56061&quot;,&quot;35d5199664e6430c896b1d49577c5390&quot;,&quot;79b4bbc47eb8423abd9278a8943eedd5&quot;,&quot;c0aba1fe5db84b6bb34106b985a7c481&quot;,&quot;91b3f5523fea410bb84bdc3f4f9847b5&quot;,&quot;6b1a16b918ad4285aca65cbaf690dd2e&quot;]}" id="XQ0HQgcp8NF1" data-outputId="b69c0749-4643-4a58-fdbc-c4299fd59d86">
<div class="sourceCode" id="cb99"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true"></a>support_state <span class="op">=</span> {<span class="st">&#39;user_question&#39;</span>: <span class="st">&#39;I have pain in both legs and trouble walking.&#39;</span>, <span class="st">&#39;question_sentiment&#39;</span>: <span class="st">&#39;Emergency&#39;</span>}</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true"></a>support_state <span class="op">=</span> get_emergency_user_information(support_state)</span></code></pre></div>
<div class="output display_data">
<div class="sourceCode" id="cb100"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;753a5b5f280f4ee1bf9a6973a2f61e04&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
</div>
<div class="cell code" id="4akI8prJdZMt">
<div class="sourceCode" id="cb101"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<section id="send-the-users-emergency-details-to-the-urgent-care-medical-team-and-confirms-them-a-doctor-will-contact-them-right-away" class="cell markdown" id="hmuhw1_O75JX">
<h1>Send the user’s emergency details to the urgent care medical team and confirms them a doctor will contact them right away.</h1>
</section>
<div class="cell code" id="sqJzkx_W8ABW">
<div class="sourceCode" id="cb102"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="41" id="Ugjuq7QjdZQQ">
<div class="sourceCode" id="cb103"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true"></a><span class="kw">def</span> dispatch_to_emergency_team(support_state: Support_Interaction_Record) <span class="op">-&gt;</span> Support_Interaction_Record:</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true"></a>  <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true"></a><span class="co">  Routes emergency contact information to the medical staff and Informs the user a doctor will get in touch as soon as possible.</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true"></a><span class="co">  &#39;&#39;&#39;</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true"></a>  <span class="co"># Retrieve emergency contact details collected earlier</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true"></a>  emergency_contact_details <span class="op">=</span> support_state.get(<span class="st">&#39;urgent_contact_information&#39;</span>, {})</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true"></a></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true"></a>  patient_name <span class="op">=</span> emergency_contact_details.get(<span class="st">&#39;name&#39;</span>, <span class="st">&#39;Patient&#39;</span>)</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true"></a>  patient_phone <span class="op">=</span> emergency_contact_details.get(<span class="st">&#39;phone&#39;</span>, <span class="st">&#39;patient phone number&#39;</span>)</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true"></a>  health_concern <span class="op">=</span> emergency_contact_details.get(<span class="st">&#39;symptoms&#39;</span>, <span class="st">&#39;health concern submitted&#39;</span>)</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true"></a></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true"></a>  output_message <span class="op">=</span> (<span class="ss">f&#39;Emergency request received.</span><span class="ch">\n</span><span class="ss">&#39;</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true"></a>        <span class="ss">f&#39;Thank you </span><span class="sc">{</span>patient_name<span class="sc">}</span><span class="ss">. Your emergency message has been received.</span><span class="ch">\n</span><span class="ss">&#39;</span></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true"></a>        <span class="ss">f&#39;A doctor will be calling you soon at </span><span class="sc">{</span>patient_phone<span class="sc">}</span><span class="ss">.</span><span class="ch">\n</span><span class="ss">&#39;</span></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true"></a>        <span class="ss">f&#39;Mentioned problem: </span><span class="sc">{</span>health_concern<span class="sc">}</span><span class="ch">\n</span><span class="ss">&#39;</span></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true"></a>        <span class="ss">f&#39;Stay in touch and ask for local emergency help if needed.&#39;</span>)</span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true"></a></span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true"></a>  support_state[<span class="st">&#39;final_response&#39;</span>] <span class="op">=</span> output_message</span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true"></a>  support_state[<span class="st">&#39;case_status&#39;</span>] <span class="op">=</span> <span class="st">&#39;Emergency doctors informed&#39;</span></span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true"></a></span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true"></a>  <span class="cf">return</span> support_state</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="42" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="Yi4tRNfe6IEd" data-outputId="d0486942-ae13-45ea-f22e-3b024d324be7">
<div class="sourceCode" id="cb104"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true"></a>support_state <span class="op">=</span> dispatch_to_emergency_team(support_state)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true"></a><span class="bu">print</span>(support_state[<span class="st">&#39;final_response&#39;</span>])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Emergency request received.
Thank you Patient. Your emergency message has been received.
A doctor will be calling you soon at patient phone number.
Mentioned problem: health concern submitted
Stay in touch and ask for local emergency help if needed.
</code></pre>
</div>
</div>
<div class="cell code" id="avJSmH2h61PT">
<div class="sourceCode" id="cb106"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true"></a><span class="co"># Check if the function works</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="43" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="p-X4DPLc5__D" data-outputId="33a141cd-1165-40a0-9544-fb1cbad51f6e">
<div class="sourceCode" id="cb107"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true"></a>support_state <span class="op">=</span> {<span class="st">&#39;urgent_contact_information&#39;</span>: {<span class="st">&#39;name&#39;</span>: <span class="st">&#39;Ram&#39;</span>, <span class="st">&#39;phone&#39;</span>: <span class="st">&#39;345-0088&#39;</span>, <span class="st">&#39;symptoms&#39;</span>: <span class="st">&#39;Extreme leg pain affecting walking&#39;</span>}}</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true"></a>support_state <span class="op">=</span> dispatch_to_emergency_team(support_state)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true"></a><span class="bu">print</span>(support_state[<span class="st">&#39;final_response&#39;</span>])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Emergency request received.
Thank you Ram. Your emergency message has been received.
A doctor will be calling you soon at 345-0088.
Mentioned problem: Extreme leg pain affecting walking
Stay in touch and ask for local emergency help if needed.
</code></pre>
</div>
</div>
<div class="cell code" id="6d9UMSKN6ACj">
<div class="sourceCode" id="cb109"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<section id="langgraph-agent-workflow-for-query-classification-sentiment-analysis-and-support-routing" class="cell markdown" id="A2x85iyIHSoI">
<h1>LangGraph agent workflow for query classification, sentiment analysis, and support routing</h1>
</section>
<div class="cell code" id="4voQD7XeF7vT">
<div class="sourceCode" id="cb110"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="44" id="Y22OZPWyw6t-">
<div class="sourceCode" id="cb111"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true"></a></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true"></a><span class="im">from</span> langgraph.checkpoint.memory <span class="im">import</span> MemorySaver</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true"></a></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true"></a><span class="co"># Define the workflow state format</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true"></a><span class="im">from</span> typing <span class="im">import</span> TypedDict</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true"></a></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true"></a><span class="kw">class</span> Support_Interaction_Record(TypedDict, total<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true"></a>    user_question: <span class="bu">str</span></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true"></a>    question_type: <span class="bu">str</span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true"></a>    question_sentiment: <span class="bu">str</span></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true"></a>    agent_reply: <span class="bu">str</span></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true"></a>    customer_support_details: <span class="bu">dict</span></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true"></a>    urgent_contact_information: <span class="bu">dict</span></span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true"></a>    human_support_contact: <span class="bu">dict</span></span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true"></a>    final_response: <span class="bu">str</span></span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true"></a>    case_status: <span class="bu">str</span></span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true"></a></span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true"></a><span class="co"># Assemble the graph</span></span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true"></a><span class="im">from</span> langgraph.graph <span class="im">import</span> StateGraph</span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true"></a>customer_support_graph <span class="op">=</span> StateGraph(Support_Interaction_Record)</span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true"></a></span>
<span id="cb111-22"><a href="#cb111-22" aria-hidden="true"></a></span>
<span id="cb111-23"><a href="#cb111-23" aria-hidden="true"></a></span>
<span id="cb111-24"><a href="#cb111-24" aria-hidden="true"></a>customer_support_graph .add_node(<span class="st">&#39;classify_question&#39;</span>, classify_question)</span>
<span id="cb111-25"><a href="#cb111-25" aria-hidden="true"></a></span>
<span id="cb111-26"><a href="#cb111-26" aria-hidden="true"></a>customer_support_graph .add_node(<span class="st">&#39;analyze_sentiment&#39;</span>, sentiment_analysis_node)</span>
<span id="cb111-27"><a href="#cb111-27" aria-hidden="true"></a></span>
<span id="cb111-28"><a href="#cb111-28" aria-hidden="true"></a>customer_support_graph .add_node(<span class="st">&#39;gather_user_contact_information&#39;</span>, gather_user_contact_information)</span>
<span id="cb111-29"><a href="#cb111-29" aria-hidden="true"></a></span>
<span id="cb111-30"><a href="#cb111-30" aria-hidden="true"></a>customer_support_graph .add_node(<span class="st">&#39;notify_human_support&#39;</span>, notify_human_support)</span>
<span id="cb111-31"><a href="#cb111-31" aria-hidden="true"></a></span>
<span id="cb111-32"><a href="#cb111-32" aria-hidden="true"></a>customer_support_graph.add_node(<span class="st">&#39;get_emergency_user_information&#39;</span>, get_emergency_user_information)</span>
<span id="cb111-33"><a href="#cb111-33" aria-hidden="true"></a></span>
<span id="cb111-34"><a href="#cb111-34" aria-hidden="true"></a>customer_support_graph.add_node(<span class="st">&#39;dispatch_to_emergency_team&#39;</span>, dispatch_to_emergency_team)</span>
<span id="cb111-35"><a href="#cb111-35" aria-hidden="true"></a></span>
<span id="cb111-36"><a href="#cb111-36" aria-hidden="true"></a>customer_support_graph .add_node(<span class="st">&#39;generate_department_response&#39;</span>, department_assistant_reply)</span>
<span id="cb111-37"><a href="#cb111-37" aria-hidden="true"></a></span>
<span id="cb111-38"><a href="#cb111-38" aria-hidden="true"></a></span>
<span id="cb111-39"><a href="#cb111-39" aria-hidden="true"></a><span class="co"># Sentiment evaluation router</span></span>
<span id="cb111-40"><a href="#cb111-40" aria-hidden="true"></a></span>
<span id="cb111-41"><a href="#cb111-41" aria-hidden="true"></a><span class="kw">def</span> Sentiment_evaluation_router(support_state: Support_Interaction_Record) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb111-42"><a href="#cb111-42" aria-hidden="true"></a>    sentiment_question <span class="op">=</span> support_state.get(<span class="st">&#39;question_sentiment&#39;</span>, <span class="st">&#39;&#39;</span>).lower()</span>
<span id="cb111-43"><a href="#cb111-43" aria-hidden="true"></a></span>
<span id="cb111-44"><a href="#cb111-44" aria-hidden="true"></a>    <span class="cf">if</span> sentiment_question <span class="kw">in</span> [<span class="st">&#39;bad&#39;</span>, <span class="st">&#39;negative&#39;</span>]:</span>
<span id="cb111-45"><a href="#cb111-45" aria-hidden="true"></a>        <span class="cf">return</span> <span class="st">&#39;gather_user_contact_information&#39;</span></span>
<span id="cb111-46"><a href="#cb111-46" aria-hidden="true"></a></span>
<span id="cb111-47"><a href="#cb111-47" aria-hidden="true"></a>    <span class="cf">if</span> sentiment_question <span class="op">==</span> <span class="st">&#39;emergency&#39;</span>:</span>
<span id="cb111-48"><a href="#cb111-48" aria-hidden="true"></a>        <span class="cf">return</span> <span class="st">&#39;get_emergency_user_information&#39;</span></span>
<span id="cb111-49"><a href="#cb111-49" aria-hidden="true"></a></span>
<span id="cb111-50"><a href="#cb111-50" aria-hidden="true"></a>    <span class="co"># Default (positive and neutral) processing branch</span></span>
<span id="cb111-51"><a href="#cb111-51" aria-hidden="true"></a>    <span class="cf">return</span> <span class="st">&#39;generate_department_response&#39;</span></span>
<span id="cb111-52"><a href="#cb111-52" aria-hidden="true"></a></span>
<span id="cb111-53"><a href="#cb111-53" aria-hidden="true"></a></span>
<span id="cb111-54"><a href="#cb111-54" aria-hidden="true"></a>customer_support_graph.set_entry_point(<span class="st">&#39;classify_question&#39;</span>)</span>
<span id="cb111-55"><a href="#cb111-55" aria-hidden="true"></a>customer_support_graph.add_edge(<span class="st">&#39;classify_question&#39;</span>, <span class="st">&#39;analyze_sentiment&#39;</span>)</span>
<span id="cb111-56"><a href="#cb111-56" aria-hidden="true"></a></span>
<span id="cb111-57"><a href="#cb111-57" aria-hidden="true"></a></span>
<span id="cb111-58"><a href="#cb111-58" aria-hidden="true"></a>customer_support_graph.add_conditional_edges(<span class="st">&#39;analyze_sentiment&#39;</span>, Sentiment_evaluation_router, [<span class="st">&#39;gather_user_contact_information&#39;</span>, <span class="st">&#39;get_emergency_user_information&#39;</span>,</span>
<span id="cb111-59"><a href="#cb111-59" aria-hidden="true"></a>                                                                                                <span class="st">&#39;generate_department_response&#39;</span>])</span>
<span id="cb111-60"><a href="#cb111-60" aria-hidden="true"></a></span>
<span id="cb111-61"><a href="#cb111-61" aria-hidden="true"></a><span class="im">from</span> langgraph.graph <span class="im">import</span> END</span>
<span id="cb111-62"><a href="#cb111-62" aria-hidden="true"></a></span>
<span id="cb111-63"><a href="#cb111-63" aria-hidden="true"></a>customer_support_graph .add_edge(<span class="st">&#39;gather_user_contact_information&#39;</span>, <span class="st">&#39;notify_human_support&#39;</span>)</span>
<span id="cb111-64"><a href="#cb111-64" aria-hidden="true"></a>customer_support_graph.add_edge(<span class="st">&#39;notify_human_support&#39;</span>, END)</span>
<span id="cb111-65"><a href="#cb111-65" aria-hidden="true"></a></span>
<span id="cb111-66"><a href="#cb111-66" aria-hidden="true"></a>customer_support_graph.add_edge(<span class="st">&#39;get_emergency_user_information&#39;</span>, <span class="st">&#39;dispatch_to_emergency_team&#39;</span>)</span>
<span id="cb111-67"><a href="#cb111-67" aria-hidden="true"></a>customer_support_graph.add_edge(<span class="st">&#39;dispatch_to_emergency_team&#39;</span>, END)</span>
<span id="cb111-68"><a href="#cb111-68" aria-hidden="true"></a></span>
<span id="cb111-69"><a href="#cb111-69" aria-hidden="true"></a>customer_support_graph.add_edge(<span class="st">&quot;generate_department_response&quot;</span>, END)</span>
<span id="cb111-70"><a href="#cb111-70" aria-hidden="true"></a></span>
<span id="cb111-71"><a href="#cb111-71" aria-hidden="true"></a><span class="co"># Activate the workflow</span></span>
<span id="cb111-72"><a href="#cb111-72" aria-hidden="true"></a></span>
<span id="cb111-73"><a href="#cb111-73" aria-hidden="true"></a><span class="im">from</span> langgraph.checkpoint.memory <span class="im">import</span> MemorySaver</span>
<span id="cb111-74"><a href="#cb111-74" aria-hidden="true"></a>activate_workflow_memorysaver <span class="op">=</span> MemorySaver()</span>
<span id="cb111-75"><a href="#cb111-75" aria-hidden="true"></a>workflow_agent_instance_compiled <span class="op">=</span> customer_support_graph.<span class="bu">compile</span>(checkpointer <span class="op">=</span> activate_workflow_memorysaver)</span></code></pre></div>
</div>
<div class="cell code" id="5RLmeXCuw7Jl">
<div class="sourceCode" id="cb112"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="46" data-colab="{&quot;height&quot;:595,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="lKnwi15VFSb8" data-outputId="fd5e8fb7-1149-4caa-a44e-cb9148da673b">
<div class="sourceCode" id="cb113"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true"></a></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true"></a></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true"></a>customer_support_pipeline_image  <span class="op">=</span> workflow_agent_instance_compiled.get_graph().draw_mermaid_png()</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true"></a></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true"></a><span class="im">from</span> IPython.display <span class="im">import</span> Markdown</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true"></a><span class="im">from</span> IPython.display <span class="im">import</span> display</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true"></a></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true"></a>display(Markdown(<span class="st">&#39;## Customer support flow graph&#39;</span>))</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true"></a></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true"></a></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true"></a>display(Image(customer_support_pipeline_image))</span></code></pre></div>
<div class="output display_data">
<pre><code>&lt;IPython.core.display.Markdown object&gt;</code></pre>
</div>
<div class="output display_data">
<p><img src="86977120d18ed9ea71aacb496e5cd9824c501637.png" /></p>
</div>
</div>
<div class="cell code" id="W7n5ZxxLFSgD">
<div class="sourceCode" id="cb115"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<section id="execute-customer-support-flow" class="cell markdown" id="cfYcQSCkHAAh">
<h1>Execute customer support flow</h1>
</section>
<div class="cell code" data-execution_count="47" id="zfwqjP2FaE1V">
<div class="sourceCode" id="cb116"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true"></a><span class="kw">def</span> run_agent_workflow(agent, user_question: <span class="bu">str</span>, user_session_id: <span class="bu">str</span>, verbose: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>):</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true"></a>  <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true"></a><span class="co">  Use the LangGraph to solve the query and reflect the final result supporting customer sentiment and category.</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true"></a><span class="co">  &#39;&#39;&#39;</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true"></a></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true"></a>  <span class="co"># Stream execution</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true"></a>  graph_items <span class="op">=</span> agent.stream({<span class="st">&#39;user_question&#39;</span>: user_question}, {<span class="st">&#39;configurable&#39;</span>: {<span class="st">&#39;thread_id&#39;</span>: user_session_id}}, stream_mode <span class="op">=</span> <span class="st">&#39;values&#39;</span>)</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true"></a>  last_item <span class="op">=</span> <span class="va">None</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true"></a>  <span class="cf">for</span>  graph_item <span class="kw">in</span> graph_items:</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true"></a>        last_item <span class="op">=</span>  graph_item</span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true"></a>        <span class="cf">if</span> verbose:</span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true"></a>            <span class="bu">print</span>(graph_item)</span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true"></a></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true"></a>  question_type <span class="op">=</span> last_item.get(<span class="st">&#39;question_type&#39;</span>, <span class="st">&#39;N/A&#39;</span>)</span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true"></a>  user_question_sentiment <span class="op">=</span> last_item.get(<span class="st">&#39;question_sentiment&#39;</span>, <span class="st">&#39;N/A&#39;</span>)</span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true"></a></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true"></a>  response_text <span class="op">=</span> (last_item.get(<span class="st">&#39;final_response&#39;</span>) <span class="kw">or</span> last_item.get(<span class="st">&#39;agent_reply&#39;</span>) <span class="kw">or</span> <span class="st">&#39;Sorry, we are unable to find a result at this moment.&#39;</span>)</span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true"></a></span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true"></a>  <span class="co"># Present output clearly if needed</span></span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true"></a>  display(Markdown(<span class="ss">f&#39;&#39;&#39;### Workflow result summary</span></span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true"></a><span class="ss">  ### Question category: </span><span class="sc">{</span>question_type<span class="sc">}</span><span class="ss">`</span></span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true"></a><span class="ss">  ###  Question sentiment: </span><span class="sc">{</span>user_question_sentiment<span class="sc">}</span><span class="ss">`</span></span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true"></a><span class="ss">  ### Support agent message</span></span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true"></a></span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true"></a><span class="ss">  </span><span class="sc">{</span>response_text<span class="sc">}</span></span>
<span id="cb116-26"><a href="#cb116-26" aria-hidden="true"></a><span class="ss">  &#39;&#39;&#39;</span>))</span>
<span id="cb116-27"><a href="#cb116-27" aria-hidden="true"></a>  <span class="cf">return</span> last_item</span></code></pre></div>
</div>
<section id="check-the-customer-service-pipeline-with-sample-data" class="cell markdown" id="ucitXUHkIOWu">
<h1>Check the customer service pipeline with sample data</h1>
</section>
<div class="cell code" id="X4EyySS-IM6g">
<div class="sourceCode" id="cb117"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="48" data-colab="{&quot;height&quot;:262,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="SUQrNkwwaE5B" data-outputId="ad05d340-b2a2-436c-9d9d-036d7b1e8614">
<div class="sourceCode" id="cb118"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true"></a>run_agent_workflow(agent <span class="op">=</span> workflow_agent_instance_compiled, user_question <span class="op">=</span> <span class="st">&#39;How can I request a copy of my medical history?&#39;</span>,</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true"></a>                   user_session_id <span class="op">=</span> <span class="st">&#39;user_session_1gb2309&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<pre><code>&lt;IPython.core.display.Markdown object&gt;</code></pre>
</div>
<div class="output execute_result" data-execution_count="48">
<pre><code>{&#39;user_question&#39;: &#39;How can I request a copy of my medical history?&#39;,
 &#39;question_type&#39;: &#39;medical_records&#39;,
 &#39;question_sentiment&#39;: &#39;Average&#39;,
 &#39;agent_reply&#39;: &#39;You can request a copy of your medical history through the patient portal or by contacting our records department.&#39;}</code></pre>
</div>
</div>
<div class="cell code" id="0Zl7WREmsIIP">
<div class="sourceCode" id="cb121"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="49" data-colab="{&quot;height&quot;:262,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="sUqwoh6XsIO3" data-outputId="4555ca84-e60b-4244-a2e7-c034a68898a7">
<div class="sourceCode" id="cb122"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true"></a>query <span class="op">=</span> <span class="st">&#39;Where can I see my account bill?&#39;</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true"></a></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true"></a>run_agent_workflow(agent <span class="op">=</span> workflow_agent_instance_compiled, user_question <span class="op">=</span> query, user_session_id <span class="op">=</span> <span class="st">&#39;user_session_1gb2784&#39;</span>, verbose<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div class="output display_data">
<pre><code>&lt;IPython.core.display.Markdown object&gt;</code></pre>
</div>
<div class="output execute_result" data-execution_count="49">
<pre><code>{&#39;user_question&#39;: &#39;Where can I see my account bill?&#39;,
 &#39;question_type&#39;: &#39;billing&#39;,
 &#39;question_sentiment&#39;: &#39;Average&#39;,
 &#39;agent_reply&#39;: &quot;You can view your account bill by logging into your patient portal and selecting &#39;Billing Statements&#39;.&quot;}</code></pre>
</div>
</div>
<div class="cell code" id="6BAKInaW-1uc">
<div class="sourceCode" id="cb125"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="50" data-colab="{&quot;height&quot;:297,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="eUYaunkuLXpz" data-outputId="50cd5ca1-2187-4029-9cbe-de960055b46d">
<div class="sourceCode" id="cb126"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true"></a>query <span class="op">=</span> <span class="st">&#39;Which physicians are currently available?&#39;</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true"></a></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true"></a>run_agent_workflow(agent <span class="op">=</span> workflow_agent_instance_compiled, user_question <span class="op">=</span> query, user_session_id <span class="op">=</span> <span class="st">&#39;user_session_1g67834&#39;</span>, verbose<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div class="output display_data">
<pre><code>&lt;IPython.core.display.Markdown object&gt;</code></pre>
</div>
<div class="output execute_result" data-execution_count="50">
<pre><code>{&#39;user_question&#39;: &#39;Which physicians are currently available?&#39;,
 &#39;question_type&#39;: &#39;appointments&#39;,
 &#39;question_sentiment&#39;: &#39;Average&#39;,
 &#39;agent_reply&#39;: &#39;The following doctors are available five days of the week: Dr. Smith (Cardiology), Dr. Johnson (Dermatology), Dr. Lee (Pediatrics), Dr. Patel (Orthopedics), and Dr. Garcia (Neurology). For more details, please check the appointment section in your portal.&#39;}</code></pre>
</div>
</div>
<div class="cell code" id="8I0jTgU5LXtY">
<div class="sourceCode" id="cb129"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="51" data-colab="{&quot;height&quot;:506,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;referenced_widgets&quot;:[&quot;d1dbfa18edaa477aa6d6091c6e19261c&quot;,&quot;734fd9f9f4e846c7ba0c8103d3da957f&quot;,&quot;da40a504057e4a2cad0bfc48e9f393d4&quot;,&quot;dcadb7ee4fe5453ebc59705fb8fbbe06&quot;,&quot;080cb1fb0a134407bb4bc3a5e139d52c&quot;,&quot;1f35f813933a48c4878da8490a411dda&quot;,&quot;f087b3a8a3084a6d8ec164570134e34d&quot;,&quot;78c7efb4755943edb6c0375a519e2b5b&quot;,&quot;31f0610f3d9e4224a3af20839056bcc3&quot;,&quot;bcf85b91778140cca2650e1387454790&quot;,&quot;50a1516fa98c4fa0afd5572205bbf0da&quot;,&quot;98125b18638a42aba05f604fd7f393d3&quot;,&quot;5673596ca385400faba894d0ba8ca6b5&quot;,&quot;e420a72184eb4a3c866ba1534b83284f&quot;,&quot;91243b18913b4b30b2aa4431f2689553&quot;,&quot;bac6cf79caef4eecb7b050be85922c2b&quot;,&quot;ed3d729bebac435ca73a01525ac69991&quot;,&quot;5166c13e0be14300849cee589455befe&quot;,&quot;5e88ce19e06840758328467c48f6dbd3&quot;,&quot;edfea07ef1c141daa57e2ea74589a5d2&quot;,&quot;a12bb4fec5004e268a7374e17a1f3563&quot;,&quot;576e634c9a734ec3b29f2b66a03c6371&quot;,&quot;b0b56bc775ec4942b5ff89559e5f23ea&quot;,&quot;51bbb5e2f9104f73b83a72f6b2ea5fcd&quot;,&quot;ea7a194f81434b48b39df27af1b0b956&quot;]}" id="qC3bkxCMNcfb" data-outputId="ad361fee-cb8d-4b6d-cf6e-4824a7bfa2c8">
<div class="sourceCode" id="cb130"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true"></a>query <span class="op">=</span> <span class="st">&#39;This billing problem has been very stressful, and no one is helping to resolve this problem.&#39;</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true"></a></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true"></a>run_agent_workflow(agent <span class="op">=</span> workflow_agent_instance_compiled, user_question <span class="op">=</span>  query, user_session_id <span class="op">=</span> <span class="st">&#39;1gb57846&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<div class="sourceCode" id="cb131"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;d1dbfa18edaa477aa6d6091c6e19261c&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<pre><code>&lt;IPython.core.display.Markdown object&gt;</code></pre>
</div>
<div class="output execute_result" data-execution_count="51">
<pre><code>{&#39;user_question&#39;: &#39;This billing problem has been very stressful, and no one is helping to resolve this problem.&#39;,
 &#39;question_type&#39;: &#39;billing&#39;,
 &#39;question_sentiment&#39;: &#39;Bad&#39;,
 &#39;agent_reply&#39;: &#39;Apologies, your contact information was not received.\nPlease try again or contact customer support directly.&#39;}</code></pre>
</div>
</div>
<div class="cell code" id="doZpHDkeNcjj">
<div class="sourceCode" id="cb134"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="52" data-colab="{&quot;height&quot;:507,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;referenced_widgets&quot;:[&quot;c41985257d364cbab0f17828291b64ec&quot;,&quot;5f57d3b30cee484c84aeb61a1ee3f912&quot;,&quot;91125aa0236e4a33886d5e5a20abd9c3&quot;,&quot;3298f7da818943d09565be635ec5aa6d&quot;,&quot;90a2757535f64d48a27bc0e73c56b735&quot;,&quot;7d4670373be54b7e9a56c41ab8939045&quot;,&quot;203d3b6af6594c128469b0a42355f93b&quot;,&quot;0bd2c567d8054df1bb47efba5ccbab8b&quot;,&quot;6c0d6b4ef5144a65921ca8fd16bae53b&quot;,&quot;0547eb86259f4484bc256461378252ef&quot;,&quot;dcce92cbb53c4b0289f37517e3efb4eb&quot;,&quot;3d273ac09480401f8ed65c91769ddfc1&quot;,&quot;ed900cdbf62b48ffb701a1eedea8e049&quot;,&quot;bfccbef6819e493d8bea1e0d07df0ce3&quot;,&quot;9680fb2206d548d4b2a72b290ba9e500&quot;,&quot;cb3fd75434db4e589b6c4cc48ac4ef7f&quot;,&quot;46b196faad1a4171bf15cfbd0132b182&quot;,&quot;fea86aa9a57d484aa6f889aa98fabe09&quot;,&quot;838fdce2b3fd493cabbe68a166e1797a&quot;]}" id="oOwf256rP-bs" data-outputId="037f76fa-0d3e-4b17-f803-44d00c7bce81">
<div class="sourceCode" id="cb135"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true"></a>query <span class="op">=</span> <span class="st">&#39;My legs hurt badly and I can’t easily walk.&#39;</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true"></a></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true"></a>run_agent_workflow(agent <span class="op">=</span> workflow_agent_instance_compiled, user_question <span class="op">=</span>  query, user_session_id <span class="op">=</span> <span class="st">&#39;1gb587906&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<div class="sourceCode" id="cb136"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;c41985257d364cbab0f17828291b64ec&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<pre><code>&lt;IPython.core.display.Markdown object&gt;</code></pre>
</div>
<div class="output execute_result" data-execution_count="52">
<pre><code>{&#39;user_question&#39;: &#39;My legs hurt badly and I can’t easily walk.&#39;,
 &#39;question_type&#39;: &#39;appointments&#39;,
 &#39;question_sentiment&#39;: &#39;Emergency&#39;,
 &#39;final_response&#39;: &#39;Emergency request received.\nThank you Patient. Your emergency message has been received.\nA doctor will be calling you soon at patient phone number.\nMentioned problem: health concern submitted\nStay in touch and ask for local emergency help if needed.&#39;,
 &#39;case_status&#39;: &#39;Emergency doctors informed&#39;}</code></pre>
</div>
</div>
<div class="cell code" id="5BFGgCO6P-fe">
<div class="sourceCode" id="cb139"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="53" data-colab="{&quot;height&quot;:262,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="mofFPlxGRl9b" data-outputId="d322ef1b-bb7e-4488-e47b-0d149bc9ff0b">
<div class="sourceCode" id="cb140"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true"></a>query <span class="op">=</span> <span class="st">&#39;Thank you, I am going to check my doctor appointment schedule right now. &#39;</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true"></a></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true"></a>run_agent_workflow(agent <span class="op">=</span> workflow_agent_instance_compiled, user_question <span class="op">=</span>  query, user_session_id <span class="op">=</span> <span class="st">&#39;1gb509375&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<pre><code>&lt;IPython.core.display.Markdown object&gt;</code></pre>
</div>
<div class="output execute_result" data-execution_count="53">
<pre><code>{&#39;user_question&#39;: &#39;Thank you, I am going to check my doctor appointment schedule right now. &#39;,
 &#39;question_type&#39;: &#39;appointments&#39;,
 &#39;question_sentiment&#39;: &#39;Good&#39;,
 &#39;agent_reply&#39;: &#39;Sorry. I could not provide right information. Please contact customer service.&#39;}</code></pre>
</div>
</div>
<div class="cell code" id="HBCm82vKRmBo">
<div class="sourceCode" id="cb143"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" id="ZbqHDkjPRmFy">
<div class="sourceCode" id="cb144"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
